jsPlumbUtil={isArray:function(b){return Object.prototype.toString.call(b)==="[object Array]"},isString:function(a){return typeof a==="string"},isBoolean:function(a){return typeof a==="boolean"},isObject:function(a){return Object.prototype.toString.call(a)==="[object Object]"},merge:function(e,d){var k=jsPlumb.extend({},e);for(var h in d){if(k[h]==null||this.isString(d[h])||this.isBoolean(d[h])){k[h]=d[h]}else{if(this.isArray(d[h])&&this.isArray(k[h])){var f=[];f.push.apply(f,k[h]);f.push.apply(f,d[h]);k[h]=f}else{if(this.isObject(k[h])&&this.isObject(d[h])){for(var g in d[h]){k[h][g]=d[h][g]}}}}}return k},convertStyle:function(b,a){if("transparent"===b){return b}var g=b,f=function(h){return h.length==1?"0"+h:h},c=function(h){return f(Number(h).toString(16))},d=/(rgb[a]?\()(.*)(\))/;if(b.match(d)){var e=b.match(d)[2].split(",");g="#"+c(e[0])+c(e[1])+c(e[2]);if(!a&&e.length==4){g=g+c(e[3])}}return g},gradient:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];return(a[1]-b[1])/(a[0]-b[0])},normal:function(b,a){return -1/jsPlumbUtil.gradient(b,a)},lineLength:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];return Math.sqrt(Math.pow(a[1]-b[1],2)+Math.pow(a[0]-b[0],2))},segment:function(b,a){b=jsPlumbUtil.isArray(b)?b:[b.x,b.y];a=jsPlumbUtil.isArray(a)?a:[a.x,a.y];if(a[0]>b[0]){return(a[1]>b[1])?2:1}else{return(a[1]>b[1])?3:4}},intersects:function(f,e){var c=f.x,a=f.x+f.w,k=f.y,h=f.y+f.h,d=e.x,b=e.x+e.w,i=e.y,g=e.y+e.h;return((c<=d&&d<=a)&&(k<=i&&i<=h))||((c<=b&&b<=a)&&(k<=i&&i<=h))||((c<=d&&d<=a)&&(k<=g&&g<=h))||((c<=b&&d<=a)&&(k<=g&&g<=h))||((d<=c&&c<=b)&&(i<=k&&k<=g))||((d<=a&&a<=b)&&(i<=k&&k<=g))||((d<=c&&c<=b)&&(i<=h&&h<=g))||((d<=a&&c<=b)&&(i<=h&&h<=g))},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(a,e,b){var d=jsPlumbUtil.gradient(a,e),i=jsPlumbUtil.segment(a,e),h=b>0?jsPlumbUtil.segmentMultipliers[i]:jsPlumbUtil.inverseSegmentMultipliers[i],c=Math.atan(d),f=Math.abs(b*Math.sin(c))*h[1],g=Math.abs(b*Math.cos(c))*h[0];return{x:a.x+g,y:a.y+f}},perpendicularLineTo:function(c,d,e){var b=jsPlumbUtil.gradient(c,d),f=Math.atan(-1/b),g=e/2*Math.sin(f),a=e/2*Math.cos(f);return[{x:d.x+a,y:d.y+g},{x:d.x-a,y:d.y-g}]},findWithFunction:function(b,d){if(b){for(var c=0;c<b.length;c++){if(d(b[c])){return c}}}return -1},indexOf:function(a,b){return jsPlumbUtil.findWithFunction(a,function(c){return c==b})},removeWithFunction:function(c,d){var b=jsPlumbUtil.findWithFunction(c,d);if(b>-1){c.splice(b,1)}return b!=-1},remove:function(b,c){var a=jsPlumbUtil.indexOf(b,c);if(a>-1){b.splice(a,1)}return a!=-1},addWithFunction:function(c,b,a){if(jsPlumbUtil.findWithFunction(c,a)==-1){c.push(b)}},addToList:function(d,b,c){var a=d[b];if(a==null){a=[],d[b]=a}a.push(c);return a},EventGenerator:function(){var c={},b=this;var a=["ready"];this.bind=function(d,e){jsPlumbUtil.addToList(c,d,e);return b};this.fire=function(g,h,d){if(c[g]){for(var f=0;f<c[g].length;f++){if(jsPlumbUtil.findWithFunction(a,function(i){return i===g})!=-1){c[g][f](h,d)}else{try{c[g][f](h,d)}catch(k){jsPlumbUtil.log("jsPlumb: fire failed for event "+g+" : "+k)}}}}return b};this.unbind=function(d){if(d){delete c[d]}else{c={}}return b};this.getListener=function(d){return c[d]}},logEnabled:true,log:function(){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){try{var b=arguments[arguments.length-1];console.log(b)}catch(a){}}},group:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.group(a)}},groupEnd:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.groupEnd(a)}},time:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.time(a)}},timeEnd:function(a){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.timeEnd(a)}}};(function(){var b=!!document.createElement("canvas").getContext,a=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),d=function(){if(d.vml==undefined){var f=document.body.appendChild(document.createElement("div"));f.innerHTML='<v:shape id="vml_flag1" adj="1" />';var e=f.firstChild;e.style.behavior="url(#default#VML)";d.vml=e?typeof e.adj=="object":true;f.parentNode.removeChild(f)}return d.vml};var c=function(i){var h={},g=[],f={},e={};this.register=function(n){var m=jsPlumb.CurrentLibrary;n=m.getElementObject(n);var p=i.getId(n),l=m.getDOMElement(n),k=m.getOffset(n);if(!h[p]){h[p]=n;g.push(n);f[p]={}}var o=function(u,q){if(u){for(var r=0;r<u.childNodes.length;r++){if(u.childNodes[r].nodeType!=3){var t=m.getElementObject(u.childNodes[r]),v=i.getId(t,null,true);if(v&&e[v]&&e[v]>0){var s=m.getOffset(t);f[p][v]={id:v,offset:{left:s.left-k.left,top:s.top-k.top}}}o(u.childNodes[r])}}}};o(l)};this.endpointAdded=function(m){var r=jsPlumb.CurrentLibrary,u=document.body,k=i.getId(m),t=r.getDOMElement(m),l=t.parentNode,o=l==u;e[k]=e[k]?e[k]+1:1;while(l!=u){var q=i.getId(l);if(h[q]){var w=-1,s=r.getElementObject(l),n=r.getOffset(s);if(f[q][k]==null){var v=jsPlumb.CurrentLibrary.getOffset(m);f[q][k]={id:k,offset:{left:v.left-n.left,top:v.top-n.top}}}break}l=l.parentNode}};this.endpointDeleted=function(l){if(e[l.elementId]){e[l.elementId]--;if(e[l.elementId]<=0){for(var k in f){delete f[k][l.elementId]}}}};this.getElementsForDraggable=function(k){return f[k]};this.reset=function(){h={};g=[];f={};e={}}};if(!window.console){window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}}window.jsPlumbAdapter={headless:false,appendToRoot:function(e){document.body.appendChild(e)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(e){return{canvas:b,svg:a,vml:d()}[e]},getDragManager:function(e){return new c(e)},setRenderMode:function(i){var h;if(i){i=i.toLowerCase();var f=this.isRenderModeAvailable("canvas"),e=this.isRenderModeAvailable("svg"),g=this.isRenderModeAvailable("vml");if(i==="svg"){if(e){h="svg"}else{if(f){h="canvas"}else{if(g){h="vml"}}}}else{if(i==="canvas"&&f){h="canvas"}else{if(g){h="vml"}}}}return h}}})();(function(){var g=jsPlumbUtil.findWithFunction,G=jsPlumbUtil.indexOf,A=jsPlumbUtil.removeWithFunction,k=jsPlumbUtil.remove,r=jsPlumbUtil.addWithFunction,i=jsPlumbUtil.addToList,l=jsPlumbUtil.isArray,z=jsPlumbUtil.isString,u=jsPlumbUtil.isObject;var v=null,c=function(H,I){return n.CurrentLibrary.getAttribute(C(H),I)},d=function(I,J,H){n.CurrentLibrary.setAttribute(C(I),J,H)},y=function(I,H){n.CurrentLibrary.addClass(C(I),H)},h=function(I,H){return n.CurrentLibrary.hasClass(C(I),H)},m=function(I,H){n.CurrentLibrary.removeClass(C(I),H)},C=function(H){return n.CurrentLibrary.getElementObject(H)},s=function(H){return n.CurrentLibrary.getOffset(C(H))},a=function(H){return n.CurrentLibrary.getSize(C(H))},o=jsPlumbUtil.log,F=jsPlumbUtil.group,f=jsPlumbUtil.groupEnd,E=jsPlumbUtil.time,t=jsPlumbUtil.timeEnd,p=function(){return""+(new Date()).getTime()},B=function(aa){var U=this,ab=arguments,S=false,M=aa.parameters||{},K=U.idPrefix,X=K+(new Date()).getTime(),W=null,ac=null;U._jsPlumb=aa._jsPlumb;U.getId=function(){return X};U.tooltip=aa.tooltip;U.hoverClass=aa.hoverClass||U._jsPlumb.Defaults.HoverClass||n.Defaults.HoverClass;jsPlumbUtil.EventGenerator.apply(this);this.clone=function(){var ad=new Object();U.constructor.apply(ad,ab);return ad};this.getParameter=function(ad){return M[ad]},this.getParameters=function(){return M},this.setParameter=function(ad,ae){M[ad]=ae},this.setParameters=function(ad){M=ad},this.overlayPlacements=[];var L=aa.beforeDetach;this.isDetachAllowed=function(ad){var ae=U._jsPlumb.checkCondition("beforeDetach",ad);if(L){try{ae=L(ad)}catch(af){o("jsPlumb: beforeDetach callback failed",af)}}return ae};var O=aa.beforeDrop;this.isDropAllowed=function(ai,af,ag,ad,ae){var ah=U._jsPlumb.checkCondition("beforeDrop",{sourceId:ai,targetId:af,scope:ag,connection:ad,dropEndpoint:ae});if(O){try{ah=O({sourceId:ai,targetId:af,scope:ag,connection:ad,dropEndpoint:ae})}catch(aj){o("jsPlumb: beforeDrop callback failed",aj)}}return ah};var Y=function(){if(W&&ac){var ad={};n.extend(ad,W);n.extend(ad,ac);delete U.hoverPaintStyle;if(ad.gradient&&W.fillStyle){delete ad.gradient}ac=ad}};this.setPaintStyle=function(ad,ae){W=ad;U.paintStyleInUse=W;Y();if(!ae){U.repaint()}};this.getPaintStyle=function(){return W};this.setHoverPaintStyle=function(ad,ae){ac=ad;Y();if(!ae){U.repaint()}};this.getHoverPaintStyle=function(){return ac};this.setHover=function(ad,af,ae){if(!U._jsPlumb.currentlyDragging&&!U._jsPlumb.isHoverSuspended()){S=ad;if(U.hoverClass!=null&&U.canvas!=null){if(ad){J.addClass(U.canvas,U.hoverClass)}else{J.removeClass(U.canvas,U.hoverClass)}}if(ac!=null){U.paintStyleInUse=ad?ac:W;ae=ae||p();U.repaint({timestamp:ae,recalc:false})}if(U.getAttachedElements&&!af){Z(ad,p(),U)}}};this.isHover=function(){return S};var V=null;this.setZIndex=function(ad){V=ad};this.getZIndex=function(){return V};var J=n.CurrentLibrary,I=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],T={mouseout:"mouseexit"},N=function(af,ag,ae){var ad=T[ae]||ae;J.bind(af,ae,function(ah){ag.fire(ad,ag,ah)})},R=function(af,ae){var ad=T[ae]||ae;J.unbind(af,ae)};this.attachListeners=function(ae,af){for(var ad=0;ad<I.length;ad++){N(ae,af,I[ad])}};var Z=function(ah,ag,ad){var af=U.getAttachedElements();if(af){for(var ae=0;ae<af.length;ae++){if(!ad||ad!=af[ae]){af[ae].setHover(ah,true,ag)}}}};this.reattachListenersForElement=function(ae){if(arguments.length>1){for(var ad=0;ad<I.length;ad++){R(ae,I[ad])}for(var ad=1;ad<arguments.length;ad++){U.attachListeners(ae,arguments[ad])}}};var H=[],P=function(ad){return ad==null?null:ad.split(" ")},Q=function(ae){if(U.getDefaultType){var ag=U.getTypeDescriptor();var af=jsPlumbUtil.merge({},U.getDefaultType());for(var ad=0;ad<H.length;ad++){af=jsPlumbUtil.merge(af,U._jsPlumb.getType(H[ad],ag))}U.applyType(af);if(!ae){U.repaint()}}};U.setType=function(ad,ae){H=P(ad)||[];Q(ae)};U.getType=function(){return H};U.hasType=function(ad){return jsPlumbUtil.indexOf(H,ad)!=-1};U.addType=function(af,ag){var ae=P(af),ah=false;if(ae!=null){for(var ad=0;ad<ae.length;ad++){if(!U.hasType(ae[ad])){H.push(ae[ad]);ah=true}}if(ah){Q(ag)}}};U.removeType=function(ag,ah){var ae=P(ag),ai=false,af=function(ak){var aj=jsPlumbUtil.indexOf(H,ak);if(aj!=-1){H.splice(aj,1);return true}return false};if(ae!=null){for(var ad=0;ad<ae.length;ad++){ai=af(ae[ad])||ai}if(ai){Q(ah)}}};U.toggleType=function(ag,ah){var af=P(ag);if(af!=null){for(var ae=0;ae<af.length;ae++){var ad=jsPlumbUtil.indexOf(H,af[ae]);if(ad!=-1){H.splice(ad,1)}else{H.push(af[ae])}}Q(ah)}};this.applyType=function(ae){U.setPaintStyle(ae.paintStyle);U.setHoverPaintStyle(ae.hoverPaintStyle);if(ae.parameters){for(var ad in ae.parameters){U.setParameter(ad,ae.parameters[ad])}}}},x=function(M){B.apply(this,arguments);var S=this;this.overlays=[];var K=function(X){var V=null;if(l(X)){var U=X[0],W=n.extend({component:S,_jsPlumb:S._jsPlumb},X[1]);if(X.length==3){n.extend(W,X[2])}V=new n.Overlays[S._jsPlumb.getRenderMode()][U](W);if(W.events){for(var T in W.events){V.bind(T,W.events[T])}}}else{if(X.constructor==String){V=new n.Overlays[S._jsPlumb.getRenderMode()][X]({component:S,_jsPlumb:S._jsPlumb})}else{V=X}}S.overlays.push(V)},L=function(X){var T=S.defaultOverlayKeys||[],W=X.overlays,U=function(Y){return S._jsPlumb.Defaults[Y]||n.Defaults[Y]||[]};if(!W){W=[]}for(var V=0;V<T.length;V++){W.unshift.apply(W,U(T[V]))}return W};var I=L(M);if(I){for(var O=0;O<I.length;O++){K(I[O])}}var H=function(V){var T=-1;for(var U=0;U<S.overlays.length;U++){if(V===S.overlays[U].id){T=U;break}}return T};this.addOverlay=function(T,U){K(T);if(!U){S.repaint()}};this.getOverlay=function(U){var T=H(U);return T>=0?S.overlays[T]:null};this.getOverlays=function(){return S.overlays};this.hideOverlay=function(U){var T=S.getOverlay(U);if(T){T.hide()}};this.hideOverlays=function(){for(var T=0;T<S.overlays.length;T++){S.overlays[T].hide()}};this.showOverlay=function(U){var T=S.getOverlay(U);if(T){T.show()}};this.showOverlays=function(){for(var T=0;T<S.overlays.length;T++){S.overlays[T].show()}};this.removeAllOverlays=function(){for(var T in S.overlays){S.overlays[T].cleanup()}S.overlays.splice(0,S.overlays.length);S.repaint()};this.removeOverlay=function(U){var T=H(U);if(T!=-1){var V=S.overlays[T];V.cleanup();S.overlays.splice(T,1)}};this.removeOverlays=function(){for(var T=0;T<arguments.length;T++){S.removeOverlay(arguments[T])}};var J="__label",R=function(V){var T={cssClass:V.cssClass,labelStyle:this.labelStyle,id:J,component:S,_jsPlumb:S._jsPlumb},U=n.extend(T,V);return new n.Overlays[S._jsPlumb.getRenderMode()].Label(U)};if(M.label){var P=M.labelLocation||S.defaultLabelLocation||0.5,Q=M.labelStyle||S._jsPlumb.Defaults.LabelStyle||n.Defaults.LabelStyle;this.overlays.push(R({label:M.label,location:P,labelStyle:Q}))}this.setLabel=function(T){var U=S.getOverlay(J);if(!U){var V=T.constructor==String||T.constructor==Function?{label:T}:T;U=R(V);this.overlays.push(U)}else{if(T.constructor==String||T.constructor==Function){U.setLabel(T)}else{if(T.label){U.setLabel(T.label)}if(T.location){U.setLocation(T.location)}}}if(!S._jsPlumb.isSuspendDrawing()){S.repaint()}};this.getLabel=function(){var T=S.getOverlay(J);return T!=null?T.getLabel():null};this.getLabelOverlay=function(){return S.getOverlay(J)};var N=this.applyType;this.applyType=function(U){N(U);S.removeAllOverlays();if(U.overlays){for(var T=0;T<U.overlays.length;T++){S.addOverlay(U.overlays[T],true)}}}},D=function(J,H,I){J.bind("click",function(K,L){H.fire("click",H,L)});J.bind("dblclick",function(K,L){H.fire("dblclick",H,L)});J.bind("contextmenu",function(K,L){H.fire("contextmenu",H,L)});J.bind("mouseenter",function(K,L){if(!H.isHover()){I(true);H.fire("mouseenter",H,L)}});J.bind("mouseexit",function(K,L){if(H.isHover()){I(false);H.fire("mouseexit",H,L)}})};var e=0,b=function(){var H=e+1;e++;return H};var w=function(I){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:true,ConnectionOverlays:[],Connector:"Bezier",ConnectorZIndex:null,Container:null,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:false,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};if(I){n.extend(this.Defaults,I)}this.logEnabled=this.Defaults.LogEnabled;var a5={},ak={};this.registerConnectionType=function(bC,bB){a5[bC]=n.extend({},bB)};this.registerConnectionTypes=function(bC){for(var bB in bC){a5[bB]=n.extend({},bC[bB])}};this.registerEndpointType=function(bC,bB){ak[bC]=n.extend({},bB)};this.registerEndpointTypes=function(bC){for(var bB in bC){ak[bB]=n.extend({},bC[bB])}};this.getType=function(bC,bB){return bB==="connection"?a5[bC]:ak[bC]};jsPlumbUtil.EventGenerator.apply(this);var bs=this,aO=b(),aR=bs.bind,aE={};for(var aD in this.Defaults){aE[aD]=this.Defaults[aD]}this.bind=function(bC,bB){if("ready"===bC&&K){bB()}else{aR.apply(bs,[bC,bB])}};bs.importDefaults=function(bC){for(var bB in bC){bs.Defaults[bB]=bC[bB]}};bs.restoreDefaults=function(){bs.Defaults=n.extend({},aE)};var O=null,au=function(){n.repaintEverything()},bu=true,aS=function(){if(bu){au()}},bk=null,K=false,a1={},aW={},aX={},ai={},bw={},bl={},br={},bA=[],af=[],R=this.Defaults.Scope,Y=null,W=function(bE,bC,bD){var bB=bE[bC];if(bB==null){bB=[];bE[bC]=bB}bB.push(bD);return bB},aY=function(bC,bB){if(bs.Defaults.Container){n.CurrentLibrary.appendElement(bC,bs.Defaults.Container)}else{if(!bB){jsPlumbAdapter.appendToRoot(bC)}else{n.CurrentLibrary.appendElement(bC,bB)}}},aF=1,am=function(){return""+aF++},aL=function(bB){return bB._nodes?bB._nodes:bB},bf=function(bD,bF,bE){if(!jsPlumbAdapter.headless&&!ba){var bG=c(bD,"id"),bB=bs.dragManager.getElementsForDraggable(bG);if(bE==null){bE=p()}bs.anchorManager.redraw(bG,bF,bE);if(bB){for(var bC in bB){bs.anchorManager.redraw(bB[bC].id,bF,bE,bB[bC].offset)}}}},aJ=function(bC,bE){var bF=null;if(l(bC)){bF=[];for(var bB=0;bB<bC.length;bB++){var bD=C(bC[bB]),bG=c(bD,"id");bF.push(bE(bD,bG))}}else{var bD=C(bC),bG=c(bD,"id");bF=bE(bD,bG)}return bF},ax=function(bB){return aX[bB]},bh=function(bF,bB,bI){if(!jsPlumbAdapter.headless){var bK=bB==null?false:bB,bG=n.CurrentLibrary;if(bK){if(bG.isDragSupported(bF)&&!bG.isAlreadyDraggable(bF)){var bJ=bI||bs.Defaults.DragOptions||n.Defaults.DragOptions;bJ=n.extend({},bJ);var bH=bG.dragEvents.drag,bC=bG.dragEvents.stop,bE=bG.dragEvents.start;bJ[bE]=ao(bJ[bE],function(){bs.setHoverSuspended(true)});bJ[bH]=ao(bJ[bH],function(){var bL=bG.getUIPosition(arguments);bf(bF,bL);y(bF,"jsPlumb_dragged")});bJ[bC]=ao(bJ[bC],function(){var bL=bG.getUIPosition(arguments);bf(bF,bL);m(bF,"jsPlumb_dragged");bs.setHoverSuspended(false)});var bD=H(bF);br[bD]=true;var bK=br[bD];bJ.disabled=bK==null?false:!bK;bG.initDraggable(bF,bJ,false);bs.dragManager.register(bF)}}}},aC=function(bH,bC){var bB=n.extend({},bH);if(bC){n.extend(bB,bC)}if(bB.source&&bB.source.endpoint){bB.sourceEndpoint=bB.source}if(bB.source&&bB.target.endpoint){bB.targetEndpoint=bB.target}if(bH.uuids){bB.sourceEndpoint=ax(bH.uuids[0]);bB.targetEndpoint=ax(bH.uuids[1])}if(bB.sourceEndpoint&&bB.sourceEndpoint.isFull()){o(bs,"could not add connection; source endpoint is full");return}if(bB.targetEndpoint&&bB.targetEndpoint.isFull()){o(bs,"could not add connection; target endpoint is full");return}if(!bB.type&&bB.sourceEndpoint){bB.type=bB.sourceEndpoint.connectionType}if(bB.sourceEndpoint&&bB.sourceEndpoint.connectorOverlays){bB.overlays=bB.overlays||[];for(var bF=0;bF<bB.sourceEndpoint.connectorOverlays.length;bF++){bB.overlays.push(bB.sourceEndpoint.connectorOverlays[bF])}}bB.tooltip=bH.tooltip;if(!bB.tooltip&&bB.sourceEndpoint&&bB.sourceEndpoint.connectorTooltip){bB.tooltip=bB.sourceEndpoint.connectorTooltip}if(bB.target&&!bB.target.endpoint&&!bB.targetEndpoint&&!bB.newConnection){var bG=H(bB.target),bI=a2[bG],bD=aK[bG];if(bI){if(!al[bG]){return}var bE=bD!=null?bD:bs.addEndpoint(bB.target,bI);if(bm[bG]){aK[bG]=bE}bB.targetEndpoint=bE;bE._makeTargetCreator=true}}if(bB.source&&!bB.source.endpoint&&!bB.sourceEndpoint&&!bB.newConnection){var bG=H(bB.source),bI=aB[bG],bD=a7[bG];if(bI){if(!ad[bG]){return}var bE=bD!=null?bD:bs.addEndpoint(bB.source,bI);if(bd[bG]){a7[bG]=bE}bB.sourceEndpoint=bE}}return bB},ae=function(bF){var bE=bs.Defaults.ConnectionType||bs.getDefaultConnectionType(),bD=bs.Defaults.EndpointType||ag,bC=n.CurrentLibrary.getParent;if(bF.container){bF.parent=bF.container}else{if(bF.sourceEndpoint){bF.parent=bF.sourceEndpoint.parent}else{if(bF.source.constructor==bD){bF.parent=bF.source.parent}else{bF.parent=bC(bF.source)}}}bF._jsPlumb=bs;var bB=new bE(bF);bB.id="con_"+am();by("click","click",bB);by("dblclick","dblclick",bB);by("contextmenu","contextmenu",bB);return bB},bz=function(bD,bE,bB){bE=bE||{};if(!bD.suspendedEndpoint){W(a1,bD.scope,bD)}if(!bE.doNotFireConnectionEvent&&bE.fireEvent!==false){var bC={connection:bD,source:bD.source,target:bD.target,sourceId:bD.sourceId,targetId:bD.targetId,sourceEndpoint:bD.endpoints[0],targetEndpoint:bD.endpoints[1]};bs.fire("jsPlumbConnection",bC,bB);bs.fire("connection",bC,bB)}bs.anchorManager.newConnection(bD);bf(bD.source)},by=function(bB,bC,bD){bD.bind(bB,function(bF,bE){bs.fire(bC,bD,bE)})},ay=function(bD){if(bD.container){return bD.container}else{var bB=n.CurrentLibrary.getTagName(bD.source),bC=n.CurrentLibrary.getParent(bD.source);if(bB&&bB.toLowerCase()==="td"){return n.CurrentLibrary.getParent(bC)}else{return bC}}},aH=function(bD){var bC=bs.Defaults.EndpointType||ag;bD.parent=ay(bD);bD._jsPlumb=bs;var bB=new bC(bD);bB.id="ep_"+am();by("click","endpointClick",bB);by("dblclick","endpointDblClick",bB);by("contextmenu","contextmenu",bB);if(!jsPlumbAdapter.headless){bs.dragManager.endpointAdded(bD.source)}return bB},V=function(bD,bG,bF){var bB=aW[bD];if(bB&&bB.length){for(var bE=0;bE<bB.length;bE++){for(var bC=0;bC<bB[bE].connections.length;bC++){var bH=bG(bB[bE].connections[bC]);if(bH){return}}if(bF){bF(bB[bE])}}}},Z=function(bC){for(var bB in aW){V(bB,bC)}},aw=function(bB,bC){if(bB!=null&&bB.parentNode!=null){bB.parentNode.removeChild(bB)}},a0=function(bD,bC){for(var bB=0;bB<bD.length;bB++){aw(bD[bB],bC)}},bp=function(bC,bB){return aJ(bC,function(bD,bE){br[bE]=bB;if(n.CurrentLibrary.isDragSupported(bD)){n.CurrentLibrary.setDraggable(bD,bB)}})},a8=function(bD,bE,bB){bE=bE==="block";var bC=null;if(bB){if(bE){bC=function(bG){bG.setVisible(true,true,true)}}else{bC=function(bG){bG.setVisible(false,true,true)}}}var bF=c(bD,"id");V(bF,function(bH){if(bE&&bB){var bG=bH.sourceId===bF?1:0;if(bH.endpoints[bG].isVisible()){bH.setVisible(true)}}else{bH.setVisible(bE)}},bC)},bn=function(bB){return aJ(bB,function(bD,bC){var bE=br[bC]==null?false:br[bC];bE=!bE;br[bC]=bE;n.CurrentLibrary.setDraggable(bD,bE);return bE})},aT=function(bB,bD){var bC=null;if(bD){bC=function(bE){var bF=bE.isVisible();bE.setVisible(!bF)}}V(bB,function(bF){var bE=bF.isVisible();bF.setVisible(!bE)},bC)},X=function(bG){var bE=bG.timestamp,bB=bG.recalc,bF=bG.offset,bC=bG.elId;if(ba&&!bE){bE=be}if(!bB){if(bE&&bE===bw[bC]){return ai[bC]}}if(bB||!bF){var bD=C(bC);if(bD!=null){af[bC]=a(bD);ai[bC]=s(bD);bw[bC]=bE}}else{ai[bC]=bF;if(af[bC]==null){var bD=C(bC);if(bD!=null){af[bC]=a(bD)}}}if(ai[bC]&&!ai[bC].right){ai[bC].right=ai[bC].left+af[bC][0];ai[bC].bottom=ai[bC].top+af[bC][1];ai[bC].width=af[bC][0];ai[bC].height=af[bC][1];ai[bC].centerx=ai[bC].left+(ai[bC].width/2);ai[bC].centery=ai[bC].top+(ai[bC].height/2)}return ai[bC]},aQ=function(bB){var bC=ai[bB];if(!bC){bC=X({elId:bB})}return{o:bC,s:af[bB]}},H=function(bB,bC,bE){var bD=C(bB);var bF=c(bD,"id");if(!bF||bF=="undefined"){if(arguments.length==2&&arguments[1]!=undefined){bF=bC}else{if(arguments.length==1||(arguments.length==3&&!arguments[2])){bF="jsPlumb_"+aO+"_"+am()}}d(bD,"id",bF)}return bF},ao=function(bD,bB,bC){bD=bD||function(){};bB=bB||function(){};return function(){var bE=null;try{bE=bB.apply(this,arguments)}catch(bF){o(bs,"jsPlumb function failed : "+bF)}if(bC==null||(bE!==bC)){try{bD.apply(this,arguments)}catch(bF){o(bs,"wrapped function failed : "+bF)}}return bE}};this.connectorClass="_jsPlumb_connector";this.endpointClass="_jsPlumb_endpoint";this.overlayClass="_jsPlumb_overlay";this.Anchors={};this.Connectors={canvas:{},svg:{},vml:{}};this.Endpoints={canvas:{},svg:{},vml:{}};this.Overlays={canvas:{},svg:{},vml:{}};this.addClass=function(bC,bB){return n.CurrentLibrary.addClass(bC,bB)};this.removeClass=function(bC,bB){return n.CurrentLibrary.removeClass(bC,bB)};this.hasClass=function(bC,bB){return n.CurrentLibrary.hasClass(bC,bB)};this.addEndpoint=function(bE,bF,bO){bO=bO||{};var bD=n.extend({},bO);n.extend(bD,bF);bD.endpoint=bD.endpoint||bs.Defaults.Endpoint||n.Defaults.Endpoint;bD.paintStyle=bD.paintStyle||bs.Defaults.EndpointStyle||n.Defaults.EndpointStyle;bE=aL(bE);var bG=[],bJ=bE.length&&bE.constructor!=String?bE:[bE];for(var bH=0;bH<bJ.length;bH++){var bM=C(bJ[bH]),bC=H(bM);bD.source=bM;X({elId:bC,timestamp:be});var bL=aH(bD);if(bD.parentAnchor){bL.parentAnchor=bD.parentAnchor}W(aW,bC,bL);var bK=ai[bC],bI=af[bC];var bN=bL.anchor.compute({xy:[bK.left,bK.top],wh:bI,element:bL,timestamp:be});var bB={anchorLoc:bN,timestamp:be};if(ba){bB.recalc=false}bL.paint(bB);bG.push(bL)}return bG.length==1?bG[0]:bG};this.addEndpoints=function(bF,bC,bB){var bE=[];for(var bD=0;bD<bC.length;bD++){var bG=bs.addEndpoint(bF,bC[bD],bB);if(l(bG)){Array.prototype.push.apply(bE,bG)}else{bE.push(bG)}}return bE};this.animate=function(bD,bC,bB){var bE=C(bD),bH=c(bD,"id");bB=bB||{};var bG=n.CurrentLibrary.dragEvents.step;var bF=n.CurrentLibrary.dragEvents.complete;bB[bG]=ao(bB[bG],function(){bs.repaint(bH)});bB[bF]=ao(bB[bF],function(){bs.repaint(bH)});n.CurrentLibrary.animate(bE,bC,bB)};this.checkCondition=function(bD,bF){var bB=bs.getListener(bD);var bE=true;if(bB&&bB.length>0){try{for(var bC=0;bC<bB.length;bC++){bE=bE&&bB[bC](bF)}}catch(bG){o(bs,"cannot check condition ["+bD+"]"+bG)}}return bE};this.connect=function(bE,bC){var bB=aC(bE,bC),bD;if(bB){if(bB.deleteEndpointsOnDetach==null){bB.deleteEndpointsOnDetach=true}bD=ae(bB);bz(bD,bB)}return bD};this.deleteEndpoint=function(bC){var bH=(typeof bC=="string")?aX[bC]:bC;if(bH){var bE=bH.getUuid();if(bE){aX[bE]=null}bH.detachAll();if(bH.endpoint.cleanup){bH.endpoint.cleanup()}a0(bH.endpoint.getDisplayElements());bs.anchorManager.deleteEndpoint(bH);for(var bG in aW){var bB=aW[bG];if(bB){var bF=[];for(var bD=0;bD<bB.length;bD++){if(bB[bD]!=bH){bF.push(bB[bD])}}aW[bG]=bF}}if(!jsPlumbAdapter.headless){bs.dragManager.endpointDeleted(bH)}}};this.deleteEveryEndpoint=function(){bs.setSuspendDrawing(true);for(var bD in aW){var bB=aW[bD];if(bB&&bB.length){for(var bC=0;bC<bB.length;bC++){bs.deleteEndpoint(bB[bC])}}}delete aW;aW={};delete aX;aX={};bs.setSuspendDrawing(false,true)};var bb=function(bE,bG,bB){var bD=bs.Defaults.ConnectionType||bs.getDefaultConnectionType(),bC=bE.constructor==bD,bF=bC?{connection:bE,source:bE.source,target:bE.target,sourceId:bE.sourceId,targetId:bE.targetId,sourceEndpoint:bE.endpoints[0],targetEndpoint:bE.endpoints[1]}:bE;if(bG){bs.fire("jsPlumbConnectionDetached",bF,bB);bs.fire("connectionDetached",bF,bB)}bs.anchorManager.connectionDetached(bF)},a9=function(bB){bs.fire("connectionDrag",bB)},aU=function(bB){bs.fire("connectionDragStop",bB)};this.detach=function(){if(arguments.length==0){return}var bF=bs.Defaults.ConnectionType||bs.getDefaultConnectionType(),bG=arguments[0].constructor==bF,bE=arguments.length==2?bG?(arguments[1]||{}):arguments[0]:arguments[0],bJ=(bE.fireEvent!==false),bD=bE.forceDetach,bC=bG?arguments[0]:bE.connection;if(bC){if(bD||(bC.isDetachAllowed(bC)&&bC.endpoints[0].isDetachAllowed(bC)&&bC.endpoints[1].isDetachAllowed(bC))){if(bD||bs.checkCondition("beforeDetach",bC)){bC.endpoints[0].detach(bC,false,true,bJ)}}}else{var bB=n.extend({},bE);if(bB.uuids){ax(bB.uuids[0]).detachFrom(ax(bB.uuids[1]),bJ)}else{if(bB.sourceEndpoint&&bB.targetEndpoint){bB.sourceEndpoint.detachFrom(bB.targetEndpoint)}else{var bI=H(bB.source),bH=H(bB.target);V(bI,function(bK){if((bK.sourceId==bI&&bK.targetId==bH)||(bK.targetId==bI&&bK.sourceId==bH)){if(bs.checkCondition("beforeDetach",bK)){bK.endpoints[0].detach(bK,false,true,bJ)}}})}}}};this.detachAllConnections=function(bD,bE){bE=bE||{};bD=C(bD);var bF=c(bD,"id"),bB=aW[bF];if(bB&&bB.length){for(var bC=0;bC<bB.length;bC++){bB[bC].detachAll(bE.fireEvent)}}};this.detachEveryConnection=function(bD){bD=bD||{};for(var bE in aW){var bB=aW[bE];if(bB&&bB.length){for(var bC=0;bC<bB.length;bC++){bB[bC].detachAll(bD.fireEvent)}}}delete a1;a1={}};this.draggable=function(bD,bB){if(typeof bD=="object"&&bD.length){for(var bC=0;bC<bD.length;bC++){var bE=C(bD[bC]);if(bE){bh(bE,true,bB)}}}else{if(bD._nodes){for(var bC=0;bC<bD._nodes.length;bC++){var bE=C(bD._nodes[bC]);if(bE){bh(bE,true,bB)}}}else{var bE=C(bD);if(bE){bh(bE,true,bB)}}}};this.extend=function(bC,bB){return n.CurrentLibrary.extend(bC,bB)};this.getDefaultEndpointType=function(){return ag};this.getDefaultConnectionType=function(){return az};var bv=function(bF,bE,bC,bB){for(var bD=0;bD<bF.length;bD++){bF[bD][bE].apply(bF[bD],bC)}return bB(bF)},T=function(bF,bE,bC){var bB=[];for(var bD=0;bD<bF.length;bD++){bB.push([bF[bD][bE].apply(bF[bD],bC),bF[bD]])}return bB},ap=function(bD,bC,bB){return function(){return bv(bD,bC,arguments,bB)}},aA=function(bC,bB){return function(){return T(bC,bB,arguments)}},bx=function(bB,bE){var bD=[];if(bB){if(typeof bB=="string"){if(bB==="*"){return bB}bD.push(bB)}else{if(bE){bD=bB}else{for(var bC=0;bC<bB.length;bC++){bD.push(H(C(bB[bC])))}}}}return bD},aI=function(bD,bC,bB){if(bD==="*"){return true}return bD.length>0?G(bD,bC)!=-1:!bB};this.getConnections=function(bK,bC){if(!bK){bK={}}else{if(bK.constructor==String){bK={scope:bK}}}var bJ=bK.scope||bs.getDefaultScope(),bI=bx(bJ,true),bB=bx(bK.source),bG=bx(bK.target),bF=(!bC&&bI.length>1)?{}:[],bL=function(bN,bO){if(!bC&&bI.length>1){var bM=bF[bN];if(bM==null){bM=[];bF[bN]=bM}bM.push(bO)}else{bF.push(bO)}};for(var bE in a1){if(aI(bI,bE)){for(var bD=0;bD<a1[bE].length;bD++){var bH=a1[bE][bD];if(aI(bB,bH.sourceId)&&aI(bG,bH.targetId)){bL(bE,bH)}}}}return bF};var L=function(bB,bC){return function(bE){for(var bD=0;bD<bB.length;bD++){bE(bB[bD])}return bC(bB)}},P=function(bB){return function(bC){return bB[bC]}};var Q=function(bB,bC){return{setHover:ap(bB,"setHover",bC),removeAllOverlays:ap(bB,"removeAllOverlays",bC),setLabel:ap(bB,"setLabel",bC),addOverlay:ap(bB,"addOverlay",bC),removeOverlay:ap(bB,"removeOverlay",bC),removeOverlays:ap(bB,"removeOverlays",bC),showOverlay:ap(bB,"showOverlay",bC),hideOverlay:ap(bB,"hideOverlay",bC),showOverlays:ap(bB,"showOverlays",bC),hideOverlays:ap(bB,"hideOverlays",bC),setPaintStyle:ap(bB,"setPaintStyle",bC),setHoverPaintStyle:ap(bB,"setHoverPaintStyle",bC),setParameter:ap(bB,"setParameter",bC),setParameters:ap(bB,"setParameters",bC),setVisible:ap(bB,"setVisible",bC),setZIndex:ap(bB,"setZIndex",bC),repaint:ap(bB,"repaint",bC),addType:ap(bB,"addType",bC),toggleType:ap(bB,"toggleType",bC),removeType:ap(bB,"removeType",bC),getLabel:aA(bB,"getLabel"),getOverlay:aA(bB,"getOverlay"),isHover:aA(bB,"isHover"),getParameter:aA(bB,"getParameter"),getParameters:aA(bB,"getParameters"),getPaintStyle:aA(bB,"getPaintStyle"),getHoverPaintStyle:aA(bB,"getHoverPaintStyle"),isVisible:aA(bB,"isVisible"),getZIndex:aA(bB,"getZIndex"),hasType:aA(bB,"hasType"),getType:aA(bB,"getType"),length:bB.length,each:L(bB,bC),get:P(bB)}};var aN=function(bC){var bB=Q(bC,aN);return n.CurrentLibrary.extend(bB,{setDetachable:ap(bC,"setDetachable",aN),setConnector:ap(bC,"setConnector",aN),detach:function(){for(var bD=0;bD<bC.length;bD++){bs.detach(bC[bD])}},isDetachable:aA(bC,"isDetachable")})};var bg=function(bC){var bB=Q(bC,bg);return n.CurrentLibrary.extend(bB,{setEnabled:ap(bC,"setEnabled",bg),isEnabled:aA(bC,"isEnabled"),detachAll:function(){for(var bD=0;bD<bC.length;bD++){bC[bD].detachAll()}},"delete":function(){for(var bD=0;bD<bC.length;bD++){bs.deleteEndpoint(bC[bD])}}})};this.select=function(bB){bB=bB||{};bB.scope=bB.scope||"*";var bC=bs.getConnections(bB,true);return aN(bC)};this.selectEndpoints=function(bJ){bJ=bJ||{};bJ.scope=bJ.scope||"*";var bO=!bJ.element&&!bJ.source&&!bJ.target,bC=bO?"*":bx(bJ.element),bD=bO?"*":bx(bJ.source),bL=bO?"*":bx(bJ.target),bQ=bx(bJ.scope,true);var bR=[];for(var bH in aW){var bF=aI(bC,bH,true),bB=aI(bD,bH,true),bG=bD!="*",bM=aI(bL,bH,true),bE=bL!="*";if(bF||bB||bM){inner:for(var bK=0;bK<aW[bH].length;bK++){var bN=aW[bH][bK];if(aI(bQ,bN.scope,true)){var bP=(bG&&bD.length>0&&!bN.isSource),bI=(bE&&bL.length>0&&!bN.isTarget);if(bP||bI){continue inner}bR.push(bN)}}}}return bg(bR)};this.getAllConnections=function(){return a1};this.getDefaultScope=function(){return R};this.getEndpoint=ax;this.getEndpoints=function(bB){return aW[H(bB)]};this.getId=H;this.getOffset=function(bC){var bB=ai[bC];return X({elId:bC})};this.getSelector=function(bB){return n.CurrentLibrary.getSelector(bB)};this.getSize=function(bC){var bB=af[bC];if(!bB){X({elId:bC})}return af[bC]};this.appendElement=aY;var aV=false;this.isHoverSuspended=function(){return aV};this.setHoverSuspended=function(bB){aV=bB};var aZ=function(bB){return function(){return jsPlumbAdapter.isRenderModeAvailable(bB)}};this.isCanvasAvailable=aZ("canvas");this.isSVGAvailable=aZ("svg");this.isVMLAvailable=aZ("vml");this.hide=function(bB,bC){a8(bB,"none",bC)};this.idstamp=am;this.init=function(){if(!K){bs.setRenderMode(bs.Defaults.RenderMode);var bB=function(bC){n.CurrentLibrary.bind(document,bC,function(bI){if(!bs.currentlyDragging&&Y==n.CANVAS){for(var bH in a1){var bJ=a1[bH];for(var bF=0;bF<bJ.length;bF++){var bE=bJ[bF].connector[bC](bI);if(bE){return}}}for(var bG in aW){var bD=aW[bG];for(var bF=0;bF<bD.length;bF++){if(bD[bF].endpoint[bC](bI)){return}}}}})};bB("click");bB("dblclick");bB("mousemove");bB("mousedown");bB("mouseup");bB("contextmenu");K=true;bs.fire("ready")}};this.log=O;this.jsPlumbUIComponent=B;this.makeAnchor=function(){if(arguments.length==0){return null}var bG=arguments[0],bD=arguments[1],bC=arguments[2],bE=null;if(bG.compute&&bG.getOrientation){return bG}else{if(typeof bG=="string"){bE=n.Anchors[arguments[0]]({elementId:bD,jsPlumbInstance:bs})}else{if(l(bG)){if(l(bG[0])||z(bG[0])){if(bG.length==2&&z(bG[0])&&u(bG[1])){var bB=n.extend({elementId:bD,jsPlumbInstance:bs},bG[1]);bE=n.Anchors[bG[0]](bB)}else{bE=new at(bG,null,bD)}}else{var bF={x:bG[0],y:bG[1],orientation:(bG.length>=4)?[bG[2],bG[3]]:[0,0],offsets:(bG.length==6)?[bG[4],bG[5]]:[0,0],elementId:bD};bE=new ab(bF);bE.clone=function(){return new ab(bF)}}}}}if(!bE.id){bE.id="anchor_"+am()}return bE};this.makeAnchors=function(bE,bC,bB){var bF=[];for(var bD=0;bD<bE.length;bD++){if(typeof bE[bD]=="string"){bF.push(n.Anchors[bE[bD]]({elementId:bC,jsPlumbInstance:bB}))}else{if(l(bE[bD])){bF.push(bs.makeAnchor(bE[bD],bC,bB))}}}return bF};this.makeDynamicAnchor=function(bB,bC){return new at(bB,bC)};var a2={},aK={},bm={},ar={},ac=function(bB,bC){bB.paintStyle=bB.paintStyle||bs.Defaults.EndpointStyles[bC]||bs.Defaults.EndpointStyle||n.Defaults.EndpointStyles[bC]||n.Defaults.EndpointStyle;bB.hoverPaintStyle=bB.hoverPaintStyle||bs.Defaults.EndpointHoverStyles[bC]||bs.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyles[bC]||n.Defaults.EndpointHoverStyle;bB.anchor=bB.anchor||bs.Defaults.Anchors[bC]||bs.Defaults.Anchor||n.Defaults.Anchors[bC]||n.Defaults.Anchor;bB.endpoint=bB.endpoint||bs.Defaults.Endpoints[bC]||bs.Defaults.Endpoint||n.Defaults.Endpoints[bC]||n.Defaults.Endpoint};this.makeTarget=function(bE,bF,bL){var bC=n.extend({_jsPlumb:bs},bL);n.extend(bC,bF);ac(bC,1);var bJ=n.CurrentLibrary,bK=bC.scope||bs.Defaults.Scope,bG=!(bC.deleteEndpointsOnDetach===false),bD=bC.maxConnections||-1,bB=bC.onMaxConnections;_doOne=function(bQ){var bO=H(bQ);a2[bO]=bC;bm[bO]=bC.uniqueEndpoint,ar[bO]=bD,al[bO]=true,proxyComponent=new B(bC);var bN=n.extend({},bC.dropOptions||{}),bM=function(){var bT=n.CurrentLibrary.getDropEvent(arguments),bV=bs.select({target:bO}).length;bs.currentlyDragging=false;var b5=C(bJ.getDragObject(arguments)),bU=c(b5,"dragId"),b3=c(b5,"originalScope"),b0=bl[bU],bS=b0.endpoints[0],bR=bC.endpoint?n.extend({},bC.endpoint):{};if(!al[bO]||ar[bO]>0&&bV>=ar[bO]){if(bB){bB({element:bQ,connection:b0},bT)}return false}bS.anchor.locked=false;if(b3){bJ.setDragScope(b5,b3)}var bY=proxyComponent.isDropAllowed(b0.sourceId,H(bQ),b0.scope,b0,null);if(b0.endpointsToDeleteOnDetach){if(bS===b0.endpointsToDeleteOnDetach[0]){b0.endpointsToDeleteOnDetach[0]=null}else{if(bS===b0.endpointsToDeleteOnDetach[1]){b0.endpointsToDeleteOnDetach[1]=null}}}if(b0.suspendedEndpoint){b0.targetId=b0.suspendedEndpoint.elementId;b0.target=bJ.getElementObject(b0.suspendedEndpoint.elementId);b0.endpoints[1]=b0.suspendedEndpoint}if(bY){bS.detach(b0,false,true,false);var b4=aK[bO]||bs.addEndpoint(bQ,bC);if(bC.uniqueEndpoint){aK[bO]=b4}b4._makeTargetCreator=true;if(b4.anchor.positionFinder!=null){var b1=bJ.getUIPosition(arguments),bX=bJ.getOffset(bQ),b2=bJ.getSize(bQ),bW=b4.anchor.positionFinder(b1,bX,b2,b4.anchor.constructorParams);b4.anchor.x=bW[0];b4.anchor.y=bW[1]}var bZ=bs.connect({source:bS,target:b4,scope:b3,previousConnection:b0,container:b0.parent,deleteEndpointsOnDetach:bG,doNotFireConnectionEvent:bS.endpointWillMoveAfterConnection});if(b0.endpoints[1]._makeTargetCreator&&b0.endpoints[1].connections.length<2){bs.deleteEndpoint(b0.endpoints[1])}if(bG){bZ.endpointsToDeleteOnDetach=[bS,b4]}bZ.repaint()}else{if(b0.suspendedEndpoint){if(bS.isReattach){b0.setHover(false);b0.floatingAnchorIndex=null;b0.suspendedEndpoint.addConnection(b0);bs.repaint(bS.elementId)}else{bS.detach(b0,false,true,true,bT)}}}};var bP=bJ.dragEvents.drop;bN.scope=bN.scope||bK;bN[bP]=ao(bN[bP],bM);bJ.initDroppable(bQ,bN,true)};bE=aL(bE);var bI=bE.length&&bE.constructor!=String?bE:[bE];for(var bH=0;bH<bI.length;bH++){_doOne(C(bI[bH]))}return bs};this.unmakeTarget=function(bC,bD){bC=n.CurrentLibrary.getElementObject(bC);var bB=H(bC);if(!bD){delete a2[bB];delete bm[bB];delete ar[bB];delete al[bB]}return bs};this.makeTargets=function(bD,bE,bB){for(var bC=0;bC<bD.length;bC++){bs.makeTarget(bD[bC],bE,bB)}};var aB={},a7={},bd={},ad={},J={},N={},al={};this.makeSource=function(bF,bG,bK){var bD=n.extend({},bK);n.extend(bD,bG);ac(bD,0);var bJ=n.CurrentLibrary,bE=bD.maxConnections||-1,bC=bD.onMaxConnections,bB=function(bS){var bM=H(bS),bT=bD.parent,bL=bT!=null?bs.getId(bJ.getElementObject(bT)):bM;aB[bL]=bD;bd[bL]=bD.uniqueEndpoint;ad[bL]=true;var bN=bJ.dragEvents.stop,bR=bJ.dragEvents.drag,bU=n.extend({},bD.dragOptions||{}),bP=bU.drag,bV=bU.stop,bW=null,bQ=false;N[bL]=bE;bU.scope=bU.scope||bD.scope;bU[bR]=ao(bU[bR],function(){if(bP){bP.apply(this,arguments)}bQ=false});bU[bN]=ao(bU[bN],function(){if(bV){bV.apply(this,arguments)}bs.currentlyDragging=false;if(bW.connections.length==0){bs.deleteEndpoint(bW)}else{bJ.unbind(bW.canvas,"mousedown");var bY=bD.anchor||bs.Defaults.Anchor,bZ=bW.anchor,b1=bW.connections[0];bW.anchor=bs.makeAnchor(bY,bM,bs);if(bD.parent){var b0=bJ.getElementObject(bD.parent);if(b0){var bX=bW.elementId;var b2=bD.container||bs.Defaults.Container||n.Defaults.Container;bW.setElement(b0,b2);bW.endpointWillMoveAfterConnection=false;bs.anchorManager.rehomeEndpoint(bX,b0);b1.previousConnection=null;A(a1[b1.scope],function(b3){return b3.id===b1.id});bs.anchorManager.connectionDetached({sourceId:b1.sourceId,targetId:b1.targetId,connection:b1});bz(b1)}}bW.repaint();bs.repaint(bW.elementId);bs.repaint(b1.targetId)}});var bO=function(b1){if(!ad[bL]){return}var bZ=bs.select({source:bL}).length;if(N[bL]>=0&&bZ>=N[bL]){if(bC){bC({element:bS,maxConnections:bE},b1)}return false}if(bG.filter){var bX=bG.filter(bJ.getOriginalEvent(b1),bS);if(bX===false){return}}var b5=X({elId:bM});var b4=((b1.pageX||b1.page.x)-b5.left)/b5.width,b3=((b1.pageY||b1.page.y)-b5.top)/b5.height,b9=b4,b8=b3;if(bD.parent){var b2=bJ.getElementObject(bD.parent),b0=H(b2);b5=X({elId:b0});b9=((b1.pageX||b1.page.x)-b5.left)/b5.width,b8=((b1.pageY||b1.page.y)-b5.top)/b5.height}var b7={};n.extend(b7,bD);b7.isSource=true;b7.anchor=[b4,b3,0,0];b7.parentAnchor=[b9,b8,0,0];b7.dragOptions=bU;if(bD.parent){var bY=b7.container||bs.Defaults.Container||n.Defaults.Container;if(bY){b7.container=bY}else{b7.container=n.CurrentLibrary.getParent(bD.parent)}}bW=bs.addEndpoint(bM,b7);bQ=true;bW.endpointWillMoveAfterConnection=bD.parent!=null;bW.endpointWillMoveTo=bD.parent?bJ.getElementObject(bD.parent):null;var b6=function(){if(bQ){bs.deleteEndpoint(bW)}};bs.registerListener(bW.canvas,"mouseup",b6);bs.registerListener(bS,"mouseup",b6);bJ.trigger(bW.canvas,"mousedown",b1)};bs.registerListener(bS,"mousedown",bO);J[bM]=bO};bF=aL(bF);var bI=bF.length&&bF.constructor!=String?bF:[bF];for(var bH=0;bH<bI.length;bH++){bB(C(bI[bH]))}return bs};this.unmakeSource=function(bC,bD){bC=n.CurrentLibrary.getElementObject(bC);var bE=H(bC),bB=J[bE];if(bB){bs.unregisterListener(_el,"mousedown",bB)}if(!bD){delete aB[bE];delete bd[bE];delete ad[bE];delete J[bE];delete N[bE]}return bs};this.unmakeEverySource=function(){for(var bB in ad){bs.unmakeSource(bB,true)}aB={};bd={};ad={};J={}};this.unmakeEveryTarget=function(){for(var bB in al){bs.unmakeTarget(bB,true)}a2={};bm={};ar={};al={};return bs};this.makeSources=function(bD,bE,bB){for(var bC=0;bC<bD.length;bC++){bs.makeSource(bD[bC],bE,bB)}return bs};var aP=function(bF,bE,bG,bB){var bC=bF=="source"?ad:al;if(z(bE)){bC[bE]=bB?!bC[bE]:bG}else{if(bE.length){bE=aL(bE);for(var bD=0;bD<bE.length;bD++){var bH=_el=n.CurrentLibrary.getElementObject(bE[bD]),bH=H(_el);bC[bH]=bB?!bC[bH]:bG}}}return bs};this.setSourceEnabled=function(bB,bC){return aP("source",bB,bC)};this.toggleSourceEnabled=function(bB){aP("source",bB,null,true);return bs.isSourceEnabled(bB)};this.isSource=function(bB){bB=n.CurrentLibrary.getElementObject(bB);return ad[H(bB)]!=null};this.isSourceEnabled=function(bB){bB=n.CurrentLibrary.getElementObject(bB);return ad[H(bB)]===true};this.setTargetEnabled=function(bB,bC){return aP("target",bB,bC)};this.toggleTargetEnabled=function(bB){return aP("target",bB,null,true);return bs.isTargetEnabled(bB)};this.isTarget=function(bB){bB=n.CurrentLibrary.getElementObject(bB);return al[H(bB)]!=null};this.isTargetEnabled=function(bB){bB=n.CurrentLibrary.getElementObject(bB);return al[H(bB)]===true};this.ready=function(bB){bs.bind("ready",bB)},this.repaint=function(bC,bE,bD){if(typeof bC=="object"){for(var bB=0;bB<bC.length;bB++){bf(C(bC[bB]),bE,bD)}}else{bf(C(bC),bE,bD)}};this.repaintEverything=function(){var bC=p();for(var bB in aW){bf(C(bB),null,bC)}};this.removeAllEndpoints=function(bD){var bB=c(bD,"id"),bE=aW[bB];if(bE){for(var bC=0;bC<bE.length;bC++){bs.deleteEndpoint(bE[bC])}}aW[bB]=[]};this.removeEveryEndpoint=this.deleteEveryEndpoint;this.removeEndpoint=function(bB,bC){bs.deleteEndpoint(bC)};var ah={},bj=function(){for(var bC in ah){for(var bB=0;bB<ah[bC].length;bB++){var bD=ah[bC][bB];n.CurrentLibrary.unbind(bD.el,bD.event,bD.listener)}}ah={}};this.registerListener=function(bC,bB,bD){n.CurrentLibrary.bind(bC,bB,bD);W(ah,bB,{el:bC,event:bB,listener:bD})};this.unregisterListener=function(bC,bB,bD){n.CurrentLibrary.unbind(bC,bB,bD);A(ah,function(bE){return bE.type==bB&&bE.listener==bD})};this.reset=function(){bs.deleteEveryEndpoint();bs.unbind();a2={};aK={};bm={};ar={};aB={};a7={};bd={};N={};bj();bs.anchorManager.reset();if(!jsPlumbAdapter.headless){bs.dragManager.reset()}};this.setDefaultScope=function(bB){R=bB};this.setDraggable=bp;this.setId=function(bF,bB,bH){var bI=bF.constructor==String?bF:bs.getId(bF),bE=bs.getConnections({source:bI,scope:"*"},true),bD=bs.getConnections({target:bI,scope:"*"},true);bB=""+bB;if(!bH){bF=n.CurrentLibrary.getElementObject(bI);n.CurrentLibrary.setAttribute(bF,"id",bB)}bF=n.CurrentLibrary.getElementObject(bB);aW[bB]=aW[bI]||[];for(var bC=0;bC<aW[bB].length;bC++){aW[bB][bC].elementId=bB;aW[bB][bC].element=bF;aW[bB][bC].anchor.elementId=bB}delete aW[bI];bs.anchorManager.changeId(bI,bB);var bG=function(bM,bJ,bL){for(var bK=0;bK<bM.length;bK++){bM[bK].endpoints[bJ].elementId=bB;bM[bK].endpoints[bJ].element=bF;bM[bK][bL+"Id"]=bB;bM[bK][bL]=bF}};bG(bE,0,"source");bG(bD,1,"target")};this.setIdChanged=function(bC,bB){bs.setId(bC,bB,true)};this.setDebugLog=function(bB){O=bB};this.setRepaintFunction=function(bB){au=bB};var ba=false,be=null;this.setSuspendDrawing=function(bC,bB){ba=bC;if(bC){be=new Date().getTime()}else{be=null}if(bB){bs.repaintEverything()}};this.isSuspendDrawing=function(){return ba};this.CANVAS="canvas";this.SVG="svg";this.VML="vml";this.setRenderMode=function(bB){Y=jsPlumbAdapter.setRenderMode(bB);return Y};this.getRenderMode=function(){return Y};this.show=function(bB,bC){a8(bB,"block",bC)};this.sizeCanvas=function(bD,bB,bF,bC,bE){if(bD){bD.style.height=bE+"px";bD.height=bE;bD.style.width=bC+"px";bD.width=bC;bD.style.left=bB+"px";bD.style.top=bF+"px"}};this.getTestHarness=function(){return{endpointsByElement:aW,endpointCount:function(bB){var bC=aW[bB];return bC?bC.length:0},connectionCount:function(bB){bB=bB||R;var bC=a1[bB];return bC?bC.length:0},getId:H,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}};this.toggle=aT;this.toggleVisible=aT;this.toggleDraggable=bn;this.unload=function(){};this.wrap=ao;this.addListener=this.bind;var bt=function(bG,bD){var bE=null,bB=bG;if(bD.tagName.toLowerCase()==="svg"&&bD.parentNode){bE=bD.parentNode}else{if(bD.offsetParent){bE=bD.offsetParent}}if(bE!=null){var bC=bE.tagName.toLowerCase()==="body"?{left:0,top:0}:s(bE),bF=bE.tagName.toLowerCase()==="body"?{left:0,top:0}:{left:bE.scrollLeft,top:bE.scrollTop};bB[0]=bG[0]-bC.left+bF.left;bB[1]=bG[1]-bC.top+bF.top}return bB};var ab=function(bF){var bD=this;this.x=bF.x||0;this.y=bF.y||0;this.elementId=bF.elementId;var bC=bF.orientation||[0,0];var bE=null,bB=null;this.offsets=bF.offsets||[0,0];bD.timestamp=null;this.compute=function(bK){var bJ=bK.xy,bG=bK.wh,bH=bK.element,bI=bK.timestamp;if(bI&&bI===bD.timestamp){return bB}bB=[bJ[0]+(bD.x*bG[0])+bD.offsets[0],bJ[1]+(bD.y*bG[1])+bD.offsets[1]];bB=bt(bB,bH.canvas);bD.timestamp=bI;return bB};this.getOrientation=function(bG){return bC};this.equals=function(bG){if(!bG){return false}var bH=bG.getOrientation();var bI=this.getOrientation();return this.x==bG.x&&this.y==bG.y&&this.offsets[0]==bG.offsets[0]&&this.offsets[1]==bG.offsets[1]&&bI[0]==bH[0]&&bI[1]==bH[1]};this.getCurrentLocation=function(){return bB}};var a4=function(bH){var bF=bH.reference,bG=bH.referenceCanvas,bD=a(C(bG)),bC=0,bI=0,bB=null,bE=null;this.x=0;this.y=0;this.isFloating=true;this.compute=function(bM){var bL=bM.xy,bK=bM.element,bJ=[bL[0]+(bD[0]/2),bL[1]+(bD[1]/2)];bJ=bt(bJ,bK.canvas);bE=bJ;return bJ};this.getOrientation=function(bK){if(bB){return bB}else{var bJ=bF.getOrientation(bK);return[Math.abs(bJ[0])*bC*-1,Math.abs(bJ[1])*bI*-1]}};this.over=function(bJ){bB=bJ.getOrientation()};this.out=function(){bB=null};this.getCurrentLocation=function(){return bE}};var at=function(bD,bC,bI){this.isSelective=true;this.isDynamic=true;var bL=[],bK=this,bJ=function(bM){return bM.constructor==ab?bM:bs.makeAnchor(bM,bI,bs)};for(var bH=0;bH<bD.length;bH++){bL[bH]=bJ(bD[bH])}this.addAnchor=function(bM){bL.push(bJ(bM))};this.getAnchors=function(){return bL};this.locked=false;var bE=bL.length>0?bL[0]:null,bG=bL.length>0?0:-1,bK=this,bF=function(bO,bM,bS,bR,bN){var bQ=bR[0]+(bO.x*bN[0]),bP=bR[1]+(bO.y*bN[1]);return Math.sqrt(Math.pow(bM-bQ,2)+Math.pow(bS-bP,2))},bB=bC||function(bW,bN,bO,bP,bM){var bR=bO[0]+(bP[0]/2),bQ=bO[1]+(bP[1]/2);var bT=-1,bV=Infinity;for(var bS=0;bS<bM.length;bS++){var bU=bF(bM[bS],bR,bQ,bW,bN);if(bU<bV){bT=bS+0;bV=bU}}return bM[bT]};this.compute=function(bQ){var bP=bQ.xy,bM=bQ.wh,bO=bQ.timestamp,bN=bQ.txy,bR=bQ.twh;if(bK.locked||bN==null||bR==null){return bE.compute(bQ)}else{bQ.timestamp=null}bE=bB(bP,bM,bN,bR,bL);bK.x=bE.x;bK.y=bE.y;return bE.compute(bQ)};this.getCurrentLocation=function(){return bE!=null?bE.getCurrentLocation():null};this.getOrientation=function(bM){return bE!=null?bE.getOrientation(bM):[0,0]};this.over=function(bM){if(bE!=null){bE.over(bM)}};this.out=function(){if(bE!=null){bE.out()}}};var bo={},aj={},aM={},U={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},bq=function(bK,bL,bH,bE){if(bK===bL){return{orientation:U.IDENTITY,a:["top","top"]}}var bC=Math.atan2((bE.centery-bH.centery),(bE.centerx-bH.centerx)),bF=Math.atan2((bH.centery-bE.centery),(bH.centerx-bE.centerx)),bG=((bH.left<=bE.left&&bH.right>=bE.left)||(bH.left<=bE.right&&bH.right>=bE.right)||(bH.left<=bE.left&&bH.right>=bE.right)||(bE.left<=bH.left&&bE.right>=bH.right)),bM=((bH.top<=bE.top&&bH.bottom>=bE.top)||(bH.top<=bE.bottom&&bH.bottom>=bE.bottom)||(bH.top<=bE.top&&bH.bottom>=bE.bottom)||(bE.top<=bH.top&&bE.bottom>=bH.bottom));if(!(bG||bM)){var bJ=null,bD=false,bB=false,bI=null;if(bE.left>bH.left&&bE.top>bH.top){bJ=["right","top"]}else{if(bE.left>bH.left&&bH.top>bE.top){bJ=["top","left"]}else{if(bE.left<bH.left&&bE.top<bH.top){bJ=["top","right"]}else{if(bE.left<bH.left&&bE.top>bH.top){bJ=["left","top"]}}}}return{orientation:U.DIAGONAL,a:bJ,theta:bC,theta2:bF}}else{if(bG){return{orientation:U.HORIZONTAL,a:bH.top<bE.top?["bottom","top"]:["top","bottom"],theta:bC,theta2:bF}}else{return{orientation:U.VERTICAL,a:bH.left<bE.left?["right","left"]:["left","right"],theta:bC,theta2:bF}}}},a6=function(bP,bL,bJ,bK,bQ,bM,bD){var bR=[],bC=bL[bQ?0:1]/(bK.length+1);for(var bN=0;bN<bK.length;bN++){var bS=(bN+1)*bC,bB=bM*bL[bQ?1:0];if(bD){bS=bL[bQ?0:1]-bS}var bI=(bQ?bS:bB),bF=bJ[0]+bI,bH=bI/bL[0],bG=(bQ?bB:bS),bE=bJ[1]+bG,bO=bG/bL[1];bR.push([bF,bE,bH,bO,bK[bN][1],bK[bN][2]])}return bR},bc=function(bC,bB){return bC[0]>bB[0]?1:-1},aa=function(bB){return function(bD,bC){var bE=true;if(bB){if(bD[0][0]<bC[0][0]){bE=true}else{bE=bD[0][1]>bC[0][1]}}else{if(bD[0][0]>bC[0][0]){bE=true}else{bE=bD[0][1]>bC[0][1]}}return bE===false?-1:1}},M=function(bC,bB){var bE=bC[0][0]<0?-Math.PI-bC[0][0]:Math.PI-bC[0][0],bD=bB[0][0]<0?-Math.PI-bB[0][0]:Math.PI-bB[0][0];if(bE>bD){return 1}else{return bC[0][1]>bB[0][1]?1:-1}},a3={top:bc,right:aa(true),bottom:aa(true),left:M},aq=function(bB,bC){return bB.sort(bC)},an=function(bC,bB){var bE=af[bC],bF=ai[bC],bD=function(bM,bT,bI,bL,bR,bQ,bH){if(bL.length>0){var bP=aq(bL,a3[bM]),bN=bM==="right"||bM==="top",bG=a6(bM,bT,bI,bP,bR,bQ,bN);var bU=function(bX,bW){var bV=bt([bW[0],bW[1]],bX.canvas);aj[bX.id]=[bV[0],bV[1],bW[2],bW[3]];aM[bX.id]=bH};for(var bJ=0;bJ<bG.length;bJ++){var bO=bG[bJ][4],bS=bO.endpoints[0].elementId===bC,bK=bO.endpoints[1].elementId===bC;if(bS){bU(bO.endpoints[0],bG[bJ])}else{if(bK){bU(bO.endpoints[1],bG[bJ])}}}}};bD("bottom",bE,[bF.left,bF.top],bB.bottom,true,1,[0,1]);bD("top",bE,[bF.left,bF.top],bB.top,true,0,[0,-1]);bD("left",bE,[bF.left,bF.top],bB.left,false,0,[-1,0]);bD("right",bE,[bF.left,bF.top],bB.right,false,1,[1,0])},aG=function(){var bB={},bF={},bC=this,bE={};this.reset=function(){bB={};bF={};bE={}};this.newConnection=function(bJ){var bL=bJ.sourceId,bI=bJ.targetId,bG=bJ.endpoints,bK=true,bH=function(bM,bN,bP,bO,bQ){if((bL==bI)&&bP.isContinuous){n.CurrentLibrary.removeElement(bG[1].canvas);bK=false}W(bF,bO,[bQ,bN,bP.constructor==at])};bH(0,bG[0],bG[0].anchor,bI,bJ);if(bK){bH(1,bG[1],bG[1].anchor,bL,bJ)}};this.connectionDetached=function(bG){var bH=bG.connection||bG;var bM=bH.sourceId,bN=bH.targetId,bQ=bH.endpoints,bL=function(bR,bS,bU,bT,bV){if(bU.constructor==a4){}else{A(bF[bT],function(bW){return bW[0].id==bV.id})}};bL(1,bQ[1],bQ[1].anchor,bM,bH);bL(0,bQ[0],bQ[0].anchor,bN,bH);var bI=bH.sourceId,bJ=bH.targetId,bP=bH.endpoints[0].id,bK=bH.endpoints[1].id,bO=function(bT,bR){if(bT){var bS=function(bU){return bU[4]==bR};A(bT.top,bS);A(bT.left,bS);A(bT.bottom,bS);A(bT.right,bS)}};bO(bE[bI],bP);bO(bE[bJ],bK);bC.redraw(bI);bC.redraw(bJ)};this.add=function(bH,bG){W(bB,bG,bH)};this.changeId=function(bH,bG){bF[bG]=bF[bH];bB[bG]=bB[bH];delete bF[bH];delete bB[bH]};this.getConnectionsFor=function(bG){return bF[bG]||[]};this.getEndpointsFor=function(bG){return bB[bG]||[]};this.deleteEndpoint=function(bG){A(bB[bG.elementId],function(bH){return bH.id==bG.id})};this.clearFor=function(bG){delete bB[bG];bB[bG]=[]};var bD=function(b0,bN,bV,bK,bQ,bR,bT,bP,b2,bS,bJ,bZ){var bX=-1,bI=-1,bL=bK.endpoints[bT],bU=bL.id,bO=[1,0][bT],bG=[[bN,bV],bK,bQ,bR,bU],bH=b0[b2],b1=bL._continuousAnchorEdge?b0[bL._continuousAnchorEdge]:null;if(b1){var bY=g(b1,function(b3){return b3[4]==bU});if(bY!=-1){b1.splice(bY,1);for(var bW=0;bW<b1.length;bW++){r(bJ,b1[bW][1],function(b3){return b3.id==b1[bW][1].id});r(bZ,b1[bW][1].endpoints[bT],function(b3){return b3.id==b1[bW][1].endpoints[bT].id})}}}for(var bW=0;bW<bH.length;bW++){if(bT==1&&bH[bW][3]===bR&&bI==-1){bI=bW}r(bJ,bH[bW][1],function(b3){return b3.id==bH[bW][1].id});r(bZ,bH[bW][1].endpoints[bT],function(b3){return b3.id==bH[bW][1].endpoints[bT].id})}if(bX!=-1){bH[bX]=bG}else{var bM=bP?bI!=-1?bI:0:bH.length;bH.splice(bM,0,bG)}bL._continuousAnchorEdge=b2};this.redraw=function(bV,bX,bI,bL){if(!ba){var b6=bB[bV]||[],b5=bF[bV]||[],bH=[],b4=[],bJ=[];bI=bI||p();bL=bL||{left:0,top:0};if(bX){bX={left:bX.left+bL.left,top:bX.top+bL.top}}X({elId:bV,offset:bX,recalc:false,timestamp:bI});var bQ=ai[bV],bM=af[bV],bS={};for(var b2=0;b2<b5.length;b2++){var bN=b5[b2][0],bP=bN.sourceId,bK=bN.targetId,bO=bN.endpoints[0].anchor.isContinuous,bU=bN.endpoints[1].anchor.isContinuous;if(bO||bU){var b3=bP+"_"+bK,b0=bK+"_"+bP,bZ=bS[b3],bT=bN.sourceId==bV?1:0;if(bO&&!bE[bP]){bE[bP]={top:[],right:[],bottom:[],left:[]}}if(bU&&!bE[bK]){bE[bK]={top:[],right:[],bottom:[],left:[]}}if(bV!=bK){X({elId:bK,timestamp:bI})}if(bV!=bP){X({elId:bP,timestamp:bI})}var bR=aQ(bK),bG=aQ(bP);if(bK==bP&&(bO||bU)){bD(bE[bP],-Math.PI/2,0,bN,false,bK,0,false,"top",bP,bH,b4)}else{if(!bZ){bZ=bq(bP,bK,bG.o,bR.o);bS[b3]=bZ}if(bO){bD(bE[bP],bZ.theta,0,bN,false,bK,0,false,bZ.a[0],bP,bH,b4)}if(bU){bD(bE[bK],bZ.theta2,-1,bN,true,bP,1,true,bZ.a[1],bK,bH,b4)}}if(bO){r(bJ,bP,function(b7){return b7===bP})}if(bU){r(bJ,bK,function(b7){return b7===bK})}r(bH,bN,function(b7){return b7.id==bN.id});if((bO&&bT==0)||(bU&&bT==1)){r(b4,bN.endpoints[bT],function(b7){return b7.id==bN.endpoints[bT].id})}}}for(var b2=0;b2<b6.length;b2++){if(b6[b2].connections.length==0&&b6[b2].anchor.isContinuous){if(!bE[bV]){bE[bV]={top:[],right:[],bottom:[],left:[]}}bD(bE[bV],-Math.PI/2,0,{endpoints:[b6[b2],b6[b2]],paint:function(){}},false,bV,0,false,"top",bV,bH,b4);r(bJ,bV,function(b7){return b7===bV})}}for(var b2=0;b2<bJ.length;b2++){an(bJ[b2],bE[bJ[b2]])}for(var b2=0;b2<b6.length;b2++){b6[b2].paint({timestamp:bI,offset:bQ,dimensions:bM})}for(var b2=0;b2<b4.length;b2++){b4[b2].paint({timestamp:bI,offset:bQ,dimensions:bM})}for(var b2=0;b2<b5.length;b2++){var bW=b5[b2][1];if(bW.anchor.constructor==at){bW.paint({elementWithPrecedence:bV});r(bH,b5[b2][0],function(b7){return b7.id==b5[b2][0].id});for(var b1=0;b1<bW.connections.length;b1++){if(bW.connections[b1]!==b5[b2][0]){r(bH,bW.connections[b1],function(b7){return b7.id==bW.connections[b1].id})}}}else{if(bW.anchor.constructor==ab){r(bH,b5[b2][0],function(b7){return b7.id==b5[b2][0].id})}}}var bY=bl[bV];if(bY){bY.paint({timestamp:bI,recalc:false,elId:bV})}for(var b2=0;b2<bH.length;b2++){bH[b2].paint({elId:bV,timestamp:bI,recalc:false})}}};this.rehomeEndpoint=function(bG,bK){var bH=bB[bG]||[],bI=bs.getId(bK);for(var bJ=0;bJ<bH.length;bJ++){bC.add(bH[bJ],bI)}bH.splice(0,bH.length)}};bs.anchorManager=new aG();bs.continuousAnchorFactory={get:function(bC){var bB=bo[bC.elementId];if(!bB){bB={type:"Continuous",compute:function(bD){return aj[bD.element.id]||[0,0]},getCurrentLocation:function(bD){return aj[bD.id]||[0,0]},getOrientation:function(bD){return aM[bD.id]||[0,0]},isDynamic:true,isContinuous:true};bo[bC.elementId]=bB}return bB}};if(!jsPlumbAdapter.headless){bs.dragManager=jsPlumbAdapter.getDragManager(bs)}var az=function(bV){var bL=this,bD=true,bQ,bR;bL.idPrefix="_jsplumb_c_";bL.defaultLabelLocation=0.5;bL.defaultOverlayKeys=["Overlays","ConnectionOverlays"];this.parent=bV.parent;x.apply(this,arguments);this.isVisible=function(){return bD};this.setVisible=function(bX){bD=bX;bL[bX?"showOverlays":"hideOverlays"]();if(bL.connector&&bL.connector.canvas){bL.connector.canvas.style.display=bX?"block":"none"}bL.repaint()};this.getTypeDescriptor=function(){return"connection"};this.getDefaultType=function(){return{parameters:{},scope:null,detachable:bL._jsPlumb.Defaults.ConnectionsDetachable,paintStyle:bL._jsPlumb.Defaults.PaintStyle||n.Defaults.PaintStyle,connector:bL._jsPlumb.Defaults.Connector||n.Defaults.Connector,hoverPaintStyle:bL._jsPlumb.Defaults.HoverPaintStyle||n.Defaults.HoverPaintStyle,overlays:bL._jsPlumb.Defaults.ConnectorOverlays||n.Defaults.ConnectorOverlays}};var bT=this.applyType;this.applyType=function(bX){bT(bX);if(bX.detachable!=null){bL.setDetachable(bX.detachable)}if(bX.scope){bL.scope=bX.scope}bL.setConnector(bX.connector)};bR=bL.setHover;bL.setHover=function(bY){var bX=bs.ConnectorZIndex||n.Defaults.ConnectorZIndex;if(bX){bL.connector.setZIndex(bX+(bY?1:0))}bL.connector.setHover.apply(bL.connector,arguments);bR.apply(bL,arguments)};bQ=function(bX){if(v==null){bL.setHover(bX,false)}};this.setConnector=function(bX,bZ){if(bL.connector!=null){a0(bL.connector.getDisplayElements(),bL.parent)}var b0={_jsPlumb:bL._jsPlumb,parent:bV.parent,cssClass:bV.cssClass,container:bV.container,tooltip:bL.tooltip};if(z(bX)){this.connector=new n.Connectors[Y][bX](b0)}else{if(l(bX)){if(bX.length==1){this.connector=new n.Connectors[Y][bX[0]](b0)}else{this.connector=new n.Connectors[Y][bX[0]](n.extend(bX[1],b0))}}}bL.canvas=bL.connector.canvas;D(bL.connector,bL,bQ);var bY=bs.ConnectorZIndex||n.Defaults.ConnectorZIndex;if(bY){bL.connector.setZIndex(bY)}if(!bZ){bL.repaint()}};this.source=C(bV.source);this.target=C(bV.target);if(bV.sourceEndpoint){this.source=bV.sourceEndpoint.endpointWillMoveTo||bV.sourceEndpoint.getElement()}if(bV.targetEndpoint){this.target=bV.targetEndpoint.getElement()}bL.previousConnection=bV.previousConnection;this.sourceId=c(this.source,"id");this.targetId=c(this.target,"id");this.scope=bV.scope;this.endpoints=[];this.endpointStyles=[];var bU=function(bY,bX){return(bY)?bs.makeAnchor(bY,bX,bs):null},bP=function(bX,b3,bY,b0,b1,bZ,b2){var b4;if(bX){bL.endpoints[b3]=bX;bX.addConnection(bL)}else{if(!bY.endpoints){bY.endpoints=[null,null]}var b9=bY.endpoints[b3]||bY.endpoint||bs.Defaults.Endpoints[b3]||n.Defaults.Endpoints[b3]||bs.Defaults.Endpoint||n.Defaults.Endpoint;if(!bY.endpointStyles){bY.endpointStyles=[null,null]}if(!bY.endpointHoverStyles){bY.endpointHoverStyles=[null,null]}var b7=bY.endpointStyles[b3]||bY.endpointStyle||bs.Defaults.EndpointStyles[b3]||n.Defaults.EndpointStyles[b3]||bs.Defaults.EndpointStyle||n.Defaults.EndpointStyle;if(b7.fillStyle==null&&bZ!=null){b7.fillStyle=bZ.strokeStyle}if(b7.outlineColor==null&&bZ!=null){b7.outlineColor=bZ.outlineColor}if(b7.outlineWidth==null&&bZ!=null){b7.outlineWidth=bZ.outlineWidth}var b6=bY.endpointHoverStyles[b3]||bY.endpointHoverStyle||bs.Defaults.EndpointHoverStyles[b3]||n.Defaults.EndpointHoverStyles[b3]||bs.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle;if(b2!=null){if(b6==null){b6={}}if(b6.fillStyle==null){b6.fillStyle=b2.strokeStyle}}var b5=bY.anchors?bY.anchors[b3]:bY.anchor?bY.anchor:bU(bs.Defaults.Anchors[b3],b1)||bU(n.Defaults.Anchors[b3],b1)||bU(bs.Defaults.Anchor,b1)||bU(n.Defaults.Anchor,b1),b8=bY.uuids?bY.uuids[b3]:null;b4=aH({paintStyle:b7,hoverPaintStyle:b6,endpoint:b9,connections:[bL],uuid:b8,anchor:b5,source:b0,scope:bY.scope,container:bY.container,reattach:bY.reattach,detachable:bY.detachable});bL.endpoints[b3]=b4;if(bY.drawEndpoints===false){b4.setVisible(false,true,true)}}return b4};var bN=bP(bV.sourceEndpoint,0,bV,bL.source,bL.sourceId,bV.paintStyle,bV.hoverPaintStyle);if(bN){W(aW,this.sourceId,bN)}var bM=bP(bV.targetEndpoint,1,bV,bL.target,bL.targetId,bV.paintStyle,bV.hoverPaintStyle);if(bM){W(aW,this.targetId,bM)}if(!this.scope){this.scope=this.endpoints[0].scope}if(bV.deleteEndpointsOnDetach){bL.endpointsToDeleteOnDetach=[bN,bM]}bL.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||bV.connector||bs.Defaults.Connector||n.Defaults.Connector,true);this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||bV.paintStyle||bs.Defaults.PaintStyle||n.Defaults.PaintStyle,true);this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||bV.hoverPaintStyle||bs.Defaults.HoverPaintStyle||n.Defaults.HoverPaintStyle,true);this.paintStyleInUse=this.getPaintStyle();X({elId:this.sourceId,timestamp:be});X({elId:this.targetId,timestamp:be});var bF=ai[this.sourceId],bE=af[this.sourceId],bB=ai[this.targetId],bI=af[this.targetId],bJ=be||p(),bO=this.endpoints[0].anchor.compute({xy:[bF.left,bF.top],wh:bE,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[bB.left,bB.top],twh:bI,tElement:this.endpoints[1],timestamp:bJ});this.endpoints[0].paint({anchorLoc:bO,timestamp:bJ});bO=this.endpoints[1].anchor.compute({xy:[bB.left,bB.top],wh:bI,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[bF.left,bF.top],twh:bE,tElement:this.endpoints[0],timestamp:bJ});this.endpoints[1].paint({anchorLoc:bO,timestamp:bJ});var bC=bs.Defaults.ConnectionsDetachable;if(bV.detachable===false){bC=false}if(bL.endpoints[0].connectionsDetachable===false){bC=false}if(bL.endpoints[1].connectionsDetachable===false){bC=false}this.isDetachable=function(){return bC===true};this.setDetachable=function(bX){bC=bX===true};var bH=bV.cost||bL.endpoints[0].getConnectionCost();bL.getCost=function(){return bH};bL.setCost=function(bX){bH=bX};var bG=!(bV.bidirectional===false);if(bV.bidirectional==null){bG=bL.endpoints[0].areConnectionsBidirectional()}bL.isBidirectional=function(){return bG};var bW=n.extend({},this.endpoints[0].getParameters());n.extend(bW,this.endpoints[1].getParameters());n.extend(bW,bL.getParameters());bL.setParameters(bW);this.getAttachedElements=function(){return bL.endpoints};this.moveParent=function(b0){var bZ=n.CurrentLibrary,bY=bZ.getParent(bL.connector.canvas);if(bL.connector.bgCanvas){bZ.removeElement(bL.connector.bgCanvas,bY);bZ.appendElement(bL.connector.bgCanvas,b0)}bZ.removeElement(bL.connector.canvas,bY);bZ.appendElement(bL.connector.canvas,b0);for(var bX=0;bX<bL.overlays.length;bX++){if(bL.overlays[bX].isAppendedAtTopLevel){bZ.removeElement(bL.overlays[bX].canvas,bY);bZ.appendElement(bL.overlays[bX].canvas,b0);if(bL.overlays[bX].reattachListeners){bL.overlays[bX].reattachListeners(bL.connector)}}}if(bL.connector.reattachListeners){bL.connector.reattachListeners()}};var bK=null;this.paint=function(ce){if(bD){ce=ce||{};var b5=ce.elId,b6=ce.ui,b3=ce.recalc,bY=ce.timestamp,b7=false,cd=b7?this.sourceId:this.targetId,b2=b7?this.targetId:this.sourceId,bZ=b7?0:1,cf=b7?1:0;if(bY==null||bY!=bK){var cg=X({elId:b5,offset:b6,recalc:b3,timestamp:bY}),b4=X({elId:cd,timestamp:bY});var b9=this.endpoints[cf],bX=this.endpoints[bZ],b1=b9.anchor.getCurrentLocation(b9),cc=bX.anchor.getCurrentLocation(bX);var b0=0;for(var cb=0;cb<bL.overlays.length;cb++){var b8=bL.overlays[cb];if(b8.isVisible()){b0=Math.max(b0,b8.computeMaxSize())}}var ca=this.connector.compute(b1,cc,this.endpoints[cf],this.endpoints[bZ],this.endpoints[cf].anchor,this.endpoints[bZ].anchor,bL.paintStyleInUse.lineWidth,b0,cg,b4);bL.connector.paint(ca,bL.paintStyleInUse);for(var cb=0;cb<bL.overlays.length;cb++){var b8=bL.overlays[cb];if(b8.isVisible){bL.overlayPlacements[cb]=b8.draw(bL.connector,bL.paintStyleInUse,ca,bY)}}}bK=bY}};this.repaint=function(bY){bY=bY||{};var bX=!(bY.recalc===false);this.paint({elId:this.sourceId,recalc:bX,timestamp:bY.timestamp})};var bS=bV.type||bL.endpoints[0].connectionType||bL.endpoints[1].connectionType;if(bS){bL.setType(bS)}};var bi=function(bC){var bB=false;return{drag:function(){if(bB){bB=false;return true}var bD=n.CurrentLibrary.getUIPosition(arguments),bE=bC.element;if(bE){n.CurrentLibrary.setOffset(bE,bD);bf(C(bE),bD)}},stopDrag:function(){bB=true}}};var av=function(bF,bE,bG,bD,bB){var bC=new a4({reference:bE,referenceCanvas:bD});return aH({paintStyle:bF,endpoint:bG,anchor:bC,source:bB,scope:"__floating"})};var S=function(bD,bB){var bF=document.createElement("div");bF.style.position="absolute";var bC=C(bF);aY(bF,bB);var bE=H(bC);X({elId:bE});bD.id=bE;bD.element=bC};var ag=function(b7){var bU=this;bU.idPrefix="_jsplumb_e_";bU.defaultLabelLocation=[0.5,0.5];bU.defaultOverlayKeys=["Overlays","EndpointOverlays"];this.parent=b7.parent;x.apply(this,arguments);b7=b7||{};this.getTypeDescriptor=function(){return"endpoint"};this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:bU._jsPlumb.Defaults.MaxConnections,paintStyle:bU._jsPlumb.Defaults.EndpointStyle||n.Defaults.EndpointStyle,endpoint:bU._jsPlumb.Defaults.Endpoint||n.Defaults.Endpoint,hoverPaintStyle:bU._jsPlumb.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,overlays:bU._jsPlumb.Defaults.EndpointOverlays||n.Defaults.EndpointOverlays,connectorStyle:b7.connectorStyle,connectorHoverStyle:b7.connectorHoverStyle,connectorClass:b7.connectorClass,connectorHoverClass:b7.connectorHoverClass,connectorOverlays:b7.connectorOverlays,connector:b7.connector,connectorTooltip:b7.connectorTooltip}};var b5=this.applyType;this.applyType=function(b9){b5(b9);if(b9.maxConnections!=null){b0=b9.maxConnections}if(b9.scope){bU.scope=b9.scope}bU.connectorStyle=b9.connectorStyle;bU.connectorHoverStyle=b9.connectorHoverStyle;bU.connectorOverlays=b9.connectorOverlays;bU.connector=b9.connector;bU.connectorTooltip=b9.connectorTooltip;bU.connectionType=b9.connectionType;bU.connectorClass=b9.connectorClass;bU.connectorHoverClass=b9.connectorHoverClass};var bG=true,bE=!(b7.enabled===false);this.isVisible=function(){return bG};this.setVisible=function(ca,cd,b9){bG=ca;if(bU.canvas){bU.canvas.style.display=ca?"block":"none"}bU[ca?"showOverlays":"hideOverlays"]();if(!cd){for(var cc=0;cc<bU.connections.length;cc++){bU.connections[cc].setVisible(ca);if(!b9){var cb=bU===bU.connections[cc].endpoints[0]?1:0;if(bU.connections[cc].endpoints[cb].connections.length==1){bU.connections[cc].endpoints[cb].setVisible(ca,true,true)}}}}};this.isEnabled=function(){return bE};this.setEnabled=function(b9){bE=b9};var bT=b7.source,bN=b7.uuid,b4=null,bI=null;if(bN){aX[bN]=bU}var bL=c(bT,"id");this.elementId=bL;this.element=bT;var bD=b7.connectionCost;this.getConnectionCost=function(){return bD};this.setConnectionCost=function(b9){bD=b9};var b3=b7.connectionsBidirectional===false?false:true;this.areConnectionsBidirectional=function(){return b3};this.setConnectionsBidirectional=function(b9){b3=b9};bU.anchor=b7.anchor?bs.makeAnchor(b7.anchor,bL,bs):b7.anchors?bs.makeAnchor(b7.anchors,bL,bs):bs.makeAnchor(bs.Defaults.Anchor||"TopCenter",bL,bs);if(!b7._transient){bs.anchorManager.add(bU,bL)}var bR=null,bW=null;this.setEndpoint=function(b9){var ca={_jsPlumb:bU._jsPlumb,parent:b7.parent,container:b7.container,tooltip:b7.tooltip,connectorTooltip:b7.connectorTooltip,endpoint:bU};if(z(b9)){bR=new n.Endpoints[Y][b9](ca)}else{if(l(b9)){ca=n.extend(b9[1],ca);bR=new n.Endpoints[Y][b9[0]](ca)}else{bR=b9.clone()}}var cb=n.extend({},ca);bR.clone=function(){var cc=new Object();bR.constructor.apply(cc,[cb]);return cc};bU.endpoint=bR;bU.type=bU.endpoint.type};this.setEndpoint(b7.endpoint||bs.Defaults.Endpoint||n.Defaults.Endpoint||"Dot");bW=bR;var bS=bU.setHover;bU.setHover=function(){bU.endpoint.setHover.apply(bU.endpoint,arguments);bS.apply(bU,arguments)};var b8=function(b9){if(bU.connections.length>0){bU.connections[0].setHover(b9,false)}else{bU.setHover(b9)}};D(bU.endpoint,bU,b8);this.setPaintStyle(b7.paintStyle||b7.style||bs.Defaults.EndpointStyle||n.Defaults.EndpointStyle,true);this.setHoverPaintStyle(b7.hoverPaintStyle||bs.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,true);this.paintStyleInUse=this.getPaintStyle();var bP=this.getPaintStyle();this.connectorStyle=b7.connectorStyle;this.connectorHoverStyle=b7.connectorHoverStyle;this.connectorOverlays=b7.connectorOverlays;this.connector=b7.connector;this.connectorTooltip=b7.connectorTooltip;this.connectorClass=b7.connectorClass;this.connectorHoverClass=b7.connectorHoverClass;this.isSource=b7.isSource||false;this.isTarget=b7.isTarget||false;var b0=b7.maxConnections||bs.Defaults.MaxConnections;this.getAttachedElements=function(){return bU.connections};this.canvas=this.endpoint.canvas;this.connections=b7.connections||[];this.scope=b7.scope||R;this.connectionType=b7.connectionType;this.timestamp=null;bU.isReattach=b7.reattach||false;bU.connectionsDetachable=bs.Defaults.ConnectionsDetachable;if(b7.connectionsDetachable===false||b7.detachable===false){bU.connectionsDetachable=false}var bO=b7.dragAllowedWhenFull||true;if(b7.onMaxConnections){bU.bind("maxConnections",b7.onMaxConnections)}this.computeAnchor=function(b9){return bU.anchor.compute(b9)};this.addConnection=function(b9){bU.connections.push(b9)};this.detach=function(ca,cf,cb,ci,b9){var ch=g(bU.connections,function(ck){return ck.id==ca.id}),cg=false;ci=(ci!==false);if(ch>=0){if(cb||ca._forceDetach||ca.isDetachable()||ca.isDetachAllowed(ca)){var cj=ca.endpoints[0]==bU?ca.endpoints[1]:ca.endpoints[0];if(cb||ca._forceDetach||(bU.isDetachAllowed(ca))){bU.connections.splice(ch,1);if(!cf){cj.detach(ca,true,cb);if(ca.endpointsToDeleteOnDetach){for(var ce=0;ce<ca.endpointsToDeleteOnDetach.length;ce++){var cc=ca.endpointsToDeleteOnDetach[ce];if(cc&&cc.connections.length==0){bs.deleteEndpoint(cc)}}}}a0(ca.connector.getDisplayElements(),ca.parent);A(a1[ca.scope],function(ck){return ck.id==ca.id});cg=true;var cd=(!cf&&ci);bb(ca,cd,b9)}}}return cg};this.detachAll=function(ca,b9){while(bU.connections.length>0){bU.detach(bU.connections[0],false,true,ca,b9)}};this.detachFrom=function(cc,cb,b9){var cd=[];for(var ca=0;ca<bU.connections.length;ca++){if(bU.connections[ca].endpoints[1]==cc||bU.connections[ca].endpoints[0]==cc){cd.push(bU.connections[ca])}}for(var ca=0;ca<cd.length;ca++){if(bU.detach(cd[ca],false,true,cb,b9)){cd[ca].setHover(false,false)}}};this.detachFromConnection=function(ca){var b9=g(bU.connections,function(cb){return cb.id==ca.id});if(b9>=0){bU.connections.splice(b9,1)}};this.getElement=function(){return bT};this.setElement=function(cc,b9){var ce=H(cc);A(aW[bU.elementId],function(cf){return cf.id==bU.id});bT=C(cc);bL=H(bT);bU.elementId=bL;var cd=ay({source:ce,container:b9}),cb=bF.getParent(bU.canvas);bF.removeElement(bU.canvas,cb);bF.appendElement(bU.canvas,cd);for(var ca=0;ca<bU.connections.length;ca++){bU.connections[ca].moveParent(cd);bU.connections[ca].sourceId=bL;bU.connections[ca].source=bT}W(aW,ce,bU)};this.getUuid=function(){return bN};this.makeInPlaceCopy=function(){var cb=bU.anchor.getCurrentLocation(bU),ca=bU.anchor.getOrientation(bU),b9={compute:function(){return[cb[0],cb[1]]},getCurrentLocation:function(){return[cb[0],cb[1]]},getOrientation:function(){return ca}};return aH({anchor:b9,source:bT,paintStyle:this.getPaintStyle(),endpoint:bR,_transient:true,scope:bU.scope})};this.isConnectedTo=function(cb){var ca=false;if(cb){for(var b9=0;b9<bU.connections.length;b9++){if(bU.connections[b9].endpoints[1]==cb){ca=true;break}}}return ca};this.isFloating=function(){return b4!=null};this.connectorSelector=function(){var b9=bU.connections[0];if(bU.isTarget&&b9){return b9}else{return(bU.connections.length<b0)||b0==-1?null:b9}};this.isFull=function(){return !(bU.isFloating()||b0<1||bU.connections.length<b0)};this.setDragAllowedWhenFull=function(b9){bO=b9};this.setStyle=bU.setPaintStyle;this.equals=function(b9){return this.anchor.equals(b9.anchor)};var bQ=function(ca){var b9=0;if(ca!=null){for(var cb=0;cb<bU.connections.length;cb++){if(bU.connections[cb].sourceId==ca||bU.connections[cb].targetId==ca){b9=cb;break}}}return bU.connections[b9]};this.paint=function(cc){cc=cc||{};var ci=cc.timestamp,ch=!(cc.recalc===false);if(!ci||bU.timestamp!==ci){X({elId:bL,timestamp:ci,recalc:ch});var co=cc.offset||ai[bL];if(co){var cf=cc.anchorPoint,cd=cc.connectorPaintStyle;if(cf==null){var b9=cc.dimensions||af[bL];if(co==null||b9==null){X({elId:bL,timestamp:ci});co=ai[bL];b9=af[bL]}var cb={xy:[co.left,co.top],wh:b9,element:bU,timestamp:ci};if(ch&&bU.anchor.isDynamic&&bU.connections.length>0){var cl=bQ(cc.elementWithPrecedence),cn=cl.endpoints[0]==bU?1:0,ce=cn==0?cl.sourceId:cl.targetId,ck=ai[ce],cm=af[ce];cb.txy=[ck.left,ck.top];cb.twh=cm;cb.tElement=cl.endpoints[cn]}cf=bU.anchor.compute(cb)}var cj=bR.compute(cf,bU.anchor.getOrientation(bU),bU.paintStyleInUse,cd||bU.paintStyleInUse);bR.paint(cj,bU.paintStyleInUse,bU.anchor);bU.timestamp=ci;for(var cg=0;cg<bU.overlays.length;cg++){var ca=bU.overlays[cg];if(ca.isVisible){bU.overlayPlacements[cg]=ca.draw(bU.endpoint,bU.paintStyleInUse,cj)}}}}};this.repaint=this.paint;this.removeConnection=this.detach;if(n.CurrentLibrary.isDragSupported(bT)){var bZ={id:null,element:null},bY=null,bC=false,bH=null,bB=bi(bZ);var bJ=function(){bY=bU.connectorSelector();var b9=true;if(!bU.isEnabled()){b9=false}if(bY==null&&!b7.isSource){b9=false}if(b7.isSource&&bU.isFull()&&!bO){b9=false}if(bY!=null&&!bY.isDetachable()){b9=false}if(b9===false){if(n.CurrentLibrary.stopDrag){n.CurrentLibrary.stopDrag()}bB.stopDrag();return false}if(bY&&!bU.isFull()&&b7.isSource){bY=null}X({elId:bL});bI=bU.makeInPlaceCopy();bI.paint();S(bZ,bU.parent);var cf=C(bI.canvas),cd=n.CurrentLibrary.getOffset(cf),ca=bt([cd.left,cd.top],bI.canvas);n.CurrentLibrary.setOffset(bZ.element,{left:ca[0],top:ca[1]});if(bU.parentAnchor){bU.anchor=bs.makeAnchor(bU.parentAnchor,bU.elementId,bs)}d(C(bU.canvas),"dragId",bZ.id);d(C(bU.canvas),"elId",bL);if(b7.proxy){bU.setPaintStyle(b7.proxy.paintStyle)}b4=av(bU.getPaintStyle(),bU.anchor,bR,bU.canvas,bZ.element);if(bY==null){bU.anchor.locked=true;bU.setHover(false,false);bY=ae({sourceEndpoint:bU,targetEndpoint:b4,source:bU.endpointWillMoveTo||C(bT),target:bZ.element,anchors:[bU.anchor,b4.anchor],paintStyle:b7.connectorStyle,hoverPaintStyle:b7.connectorHoverStyle,connector:b7.connector,overlays:b7.connectorOverlays,type:bU.connectionType,cssClass:bU.connectorClass,hoverClass:bU.connectorHoverClass})}else{bC=true;bY.connector.setHover(false,false);bK(C(bI.canvas),false,true);var cc=bY.endpoints[0].id==bU.id?0:1;bY.floatingAnchorIndex=cc;bU.detachFromConnection(bY);var cg=C(bU.canvas),ce=n.CurrentLibrary.getDragScope(cg);d(cg,"originalScope",ce);var cb=n.CurrentLibrary.getDropScope(cg);n.CurrentLibrary.setDragScope(cg,cb);if(cc==0){bH=[bY.source,bY.sourceId,b2,ce];bY.source=bZ.element;bY.sourceId=bZ.id}else{bH=[bY.target,bY.targetId,b2,ce];bY.target=bZ.element;bY.targetId=bZ.id}bY.endpoints[cc==0?1:0].anchor.locked=true;bY.suspendedEndpoint=bY.endpoints[cc];bY.suspendedEndpoint.setHover(false);bY.endpoints[cc]=b4;a9(bY)}bl[bZ.id]=bY;b4.addConnection(bY);W(aW,bZ.id,b4);bs.currentlyDragging=true};var bF=n.CurrentLibrary,b1=b7.dragOptions||{},bV=n.extend({},bF.defaultDragOptions),bX=bF.dragEvents.start,b6=bF.dragEvents.stop,bM=bF.dragEvents.drag;b1=n.extend(bV,b1);b1.scope=b1.scope||bU.scope;b1[bX]=ao(b1[bX],bJ);b1[bM]=ao(b1[bM],bB.drag);b1[b6]=ao(b1[b6],function(){var ca=bF.getDropEvent(arguments);bs.currentlyDragging=false;A(aW[bZ.id],function(cb){return cb.id==b4.id});a0([bZ.element[0],b4.canvas],bT);aw(bI.canvas,bT);bs.anchorManager.clearFor(bZ.id);var b9=bY.floatingAnchorIndex==null?1:bY.floatingAnchorIndex;bY.endpoints[b9==0?1:0].anchor.locked=false;bU.setPaintStyle(bP);if(bY.endpoints[b9]==b4){if(bC&&bY.suspendedEndpoint){if(b9==0){bY.source=bH[0];bY.sourceId=bH[1]}else{bY.target=bH[0];bY.targetId=bH[1]}n.CurrentLibrary.setDragScope(bH[2],bH[3]);bY.endpoints[b9]=bY.suspendedEndpoint;if(bU.isReattach||bY._forceDetach||!bY.endpoints[b9==0?1:0].detach(bY,false,false,true,ca)){bY.setHover(false);bY.floatingAnchorIndex=null;bY.suspendedEndpoint.addConnection(bY);bs.repaint(bH[1])}bY._forceDetach=null}else{a0(bY.connector.getDisplayElements(),bU.parent);bU.detachFromConnection(bY)}}bU.anchor.locked=false;bU.paint({recalc:false});bY.setHover(false,false);aU(bY);bY=null;bI=null;delete aW[b4.elementId];b4.anchor=null;b4=null;bs.currentlyDragging=false});var b2=C(bU.canvas);n.CurrentLibrary.initDraggable(b2,b1,true)}var bK=function(cb,cg,ce,ch){if((b7.isTarget||cg)&&n.CurrentLibrary.isDropSupported(bT)){var cc=b7.dropOptions||bs.Defaults.DropOptions||n.Defaults.DropOptions;cc=n.extend({},cc);cc.scope=cc.scope||bU.scope;var ca=n.CurrentLibrary.dragEvents.drop,cf=n.CurrentLibrary.dragEvents.over,b9=n.CurrentLibrary.dragEvents.out,cd=function(){var ci=n.CurrentLibrary.getDropEvent(arguments),cv=C(n.CurrentLibrary.getDragObject(arguments)),cj=c(cv,"dragId"),cm=c(cv,"elId"),cu=c(cv,"originalScope"),cp=bl[cj];if(cp!=null){var cr=cp.floatingAnchorIndex==null?1:cp.floatingAnchorIndex,cs=cr==0?1:0;if(cu){n.CurrentLibrary.setDragScope(cv,cu)}var ct=ch!=null?ch.isEnabled():true;if(bU.isFull()){bU.fire("maxConnections",{endpoint:bU,connection:cp,maxConnections:b0},ci)}if(!bU.isFull()&&!(cr==0&&!bU.isSource)&&!(cr==1&&!bU.isTarget)&&ct){var cn=true;if(cp.suspendedEndpoint&&cp.suspendedEndpoint.id!=bU.id){if(cr==0){cp.source=cp.suspendedEndpoint.element;cp.sourceId=cp.suspendedEndpoint.elementId}else{cp.target=cp.suspendedEndpoint.element;cp.targetId=cp.suspendedEndpoint.elementId}if(!cp.isDetachAllowed(cp)||!cp.endpoints[cr].isDetachAllowed(cp)||!cp.suspendedEndpoint.isDetachAllowed(cp)||!bs.checkCondition("beforeDetach",cp)){cn=false}}if(cr==0){cp.source=bU.element;cp.sourceId=bU.elementId}else{cp.target=bU.element;cp.targetId=bU.elementId}cn=cn&&bU.isDropAllowed(cp.sourceId,cp.targetId,cp.scope,cp,bU);if(cn){cp.endpoints[cr].detachFromConnection(cp);if(cp.suspendedEndpoint){cp.suspendedEndpoint.detachFromConnection(cp)}cp.endpoints[cr]=bU;bU.addConnection(cp);var cl=bU.getParameters();for(var cq in cl){cp.setParameter(cq,cl[cq])}if(!cp.suspendedEndpoint){if(cl.draggable){n.CurrentLibrary.initDraggable(bU.element,b1,true)}}else{var co=cp.suspendedEndpoint.getElement(),ck=cp.suspendedEndpoint.elementId;bb({source:cr==0?co:cp.source,target:cr==1?co:cp.target,sourceId:cr==0?ck:cp.sourceId,targetId:cr==1?ck:cp.targetId,sourceEndpoint:cr==0?cp.suspendedEndpoint:cp.endpoints[0],targetEndpoint:cr==1?cp.suspendedEndpoint:cp.endpoints[1],connection:cp},true,ci)}bz(cp,null,ci)}else{if(cp.suspendedEndpoint){cp.endpoints[cr]=cp.suspendedEndpoint;cp.setHover(false);cp._forceDetach=true;if(cr==0){cp.source=cp.suspendedEndpoint.element;cp.sourceId=cp.suspendedEndpoint.elementId}else{cp.target=cp.suspendedEndpoint.element;cp.targetId=cp.suspendedEndpoint.elementId}cp.suspendedEndpoint.addConnection(cp);cp.endpoints[0].repaint();cp.repaint();bs.repaint(cp.source.elementId);cp._forceDetach=false}}cp.floatingAnchorIndex=null}bs.currentlyDragging=false;delete bl[cj]}};cc[ca]=ao(cc[ca],cd);cc[cf]=ao(cc[cf],function(){if(bU.isTarget){var cj=n.CurrentLibrary.getDragObject(arguments),cl=c(C(cj),"dragId"),ck=bl[cl];if(ck!=null){var ci=ck.floatingAnchorIndex==null?1:ck.floatingAnchorIndex;ck.endpoints[ci].anchor.over(bU.anchor)}}});cc[b9]=ao(cc[b9],function(){if(bU.isTarget){var cj=n.CurrentLibrary.getDragObject(arguments),cl=c(C(cj),"dragId"),ck=bl[cl];if(ck!=null){var ci=ck.floatingAnchorIndex==null?1:ck.floatingAnchorIndex;ck.endpoints[ci].anchor.out()}}});n.CurrentLibrary.initDroppable(cb,cc,true,ce)}};bK(C(bU.canvas),true,!(b7._transient||bU.anchor.isFloating),bU);if(b7.type){bU.setType(b7.type)}return bU}};var n=new w();if(typeof window!="undefined"){window.jsPlumb=n}n.getInstance=function(I){var H=new w(I);H.init();return H};var q=function(H,M,J,I,L,K){return function(O){O=O||{};var N=O.jsPlumbInstance.makeAnchor([H,M,J,I,0,0],O.elementId,O.jsPlumbInstance);N.type=L;if(K){K(N,O)}return N}};n.Anchors.TopCenter=q(0.5,0,0,-1,"TopCenter");n.Anchors.BottomCenter=q(0.5,1,0,1,"BottomCenter");n.Anchors.LeftMiddle=q(0,0.5,-1,0,"LeftMiddle");n.Anchors.RightMiddle=q(1,0.5,1,0,"RightMiddle");n.Anchors.Center=q(0.5,0.5,0,0,"Center");n.Anchors.TopRight=q(1,0,0,-1,"TopRight");n.Anchors.BottomRight=q(1,1,0,1,"BottomRight");n.Anchors.TopLeft=q(0,0,0,-1,"TopLeft");n.Anchors.BottomLeft=q(0,1,0,1,"BottomLeft");n.Defaults.DynamicAnchors=function(H){return H.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],H.elementId,H.jsPlumbInstance)};n.Anchors.AutoDefault=function(I){var H=I.jsPlumbInstance.makeDynamicAnchor(n.Defaults.DynamicAnchors(I));H.type="AutoDefault";return H};n.Anchors.Assign=q(0,0,0,0,"Assign",function(I,J){var H=J.position||"Fixed";I.positionFinder=H.constructor==String?J.jsPlumbInstance.AnchorPositionFinders[H]:H;I.constructorParams=J});n.Anchors.Continuous=function(H){return H.jsPlumbInstance.continuousAnchorFactory.get(H)};n.AnchorPositionFinders={Fixed:function(K,H,J,I){return[(K.left-H.left)/J[0],(K.top-H.top)/J[1]]},Grid:function(H,Q,L,I){var P=H.left-Q.left,O=H.top-Q.top,N=L[0]/(I.grid[0]),M=L[1]/(I.grid[1]),K=Math.floor(P/N),J=Math.floor(O/M);return[((K*N)+(N/2))/L[0],((J*M)+(M/2))/L[1]]}};n.Anchors.Perimeter=function(H){H=H||{};var I=H.anchorCount||60,L=H.shape;if(!L){throw new Error("no shape supplied to Perimeter Anchor type")}var J=function(){var U=0.5,T=Math.PI*2/I,V=0,R=[];for(var S=0;S<I;S++){var Q=U+(U*Math.sin(V)),W=U+(U*Math.cos(V));R.push([Q,W,0,0]);V+=T}return R},O=function(Q){var U=I/Q.length,R=[],S=function(Y,ab,X,aa){var W=(X-Y)/U,V=(aa-ab)/U;for(var Z=0;Z<U;Z++){R.push([Y+(W*Z),ab+(V*Z),0,0])}};for(var T=0;T<Q.length;T++){S.apply(null,Q[T])}return R},M=function(){return O([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])};var K={circle:J,ellipse:J,diamond:function(){return O([[0.5,0,1,0.5],[1,0.5,0.5,1],[0.5,1,0,0.5],[0,0.5,0.5,0]])},rectangle:M,square:M,triangle:function(){return O([[0.5,0,1,1],[1,1,0,1],[0,1,0.5,0]])}};if(!K[L]){throw new Error("Shape ["+L+"] is unknown by Perimeter Anchor type")}var P=K[L](),N=H.jsPlumbInstance.makeDynamicAnchor(P);N.type="Perimeter";return N}})();(function(){jsPlumb.DOMElementComponent=function(d){jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(f){}};jsPlumb.Connectors.Straight=function(){this.type="Straight";var s=this,k=null,f,l,q,o,m,g,r,i,h,e,d,p,n;this.compute=function(B,K,t,A,G,u,E,z){var J=Math.abs(B[0]-K[0]),D=Math.abs(B[1]-K[1]),C=0.45*J,v=0.45*D;J*=1.9;D*=1.9;var H=Math.min(B[0],K[0])-C;var F=Math.min(B[1],K[1])-v;var I=Math.max(2*E,z);if(J<I){J=I;H=B[0]+((K[0]-B[0])/2)-(I/2);C=(J-Math.abs(B[0]-K[0]))/2}if(D<I){D=I;F=B[1]+((K[1]-B[1])/2)-(I/2);v=(D-Math.abs(B[1]-K[1]))/2}i=B[0]<K[0]?C:J-C;h=B[1]<K[1]?v:D-v;e=B[0]<K[0]?J-C:C;d=B[1]<K[1]?D-v:v;k=[H,F,J,D,i,h,e,d];o=e-i,m=d-h;f=jsPlumbUtil.gradient({x:i,y:h},{x:e,y:d}),l=-1/f;q=-1*((f*i)-h);g=Math.atan(f);r=Math.atan(l);n=Math.sqrt((o*o)+(m*m));return k};this.pointOnPath=function(u,v){if(u==0&&!v){return{x:i,y:h}}else{if(u==1&&!v){return{x:e,y:d}}else{var t=v?u>0?u:n+u:u*n;return jsPlumbUtil.pointOnLine({x:i,y:h},{x:e,y:d},t)}}};this.gradientAtPoint=function(t){return f};this.pointAlongPathFrom=function(t,x,w){var v=s.pointOnPath(t,w),u=t==1?{x:i+((e-i)*10),y:h+((h-d)*10)}:{x:e,y:d};return jsPlumbUtil.pointOnLine(v,u,x)}};jsPlumb.Connectors.Bezier=function(w){var q=this;w=w||{};this.majorAnchor=w.curviness||150;this.minorAnchor=10;var u=null;this.type="Bezier";this._findControlPoint=function(I,x,D,y,B,G,z){var F=G.getOrientation(y),H=z.getOrientation(B),C=F[0]!=H[0]||F[1]==H[1],A=[],J=q.majorAnchor,E=q.minorAnchor;if(!C){if(F[0]==0){A.push(x[0]<D[0]?I[0]+E:I[0]-E)}else{A.push(I[0]-(J*F[0]))}if(F[1]==0){A.push(x[1]<D[1]?I[1]+E:I[1]-E)}else{A.push(I[1]+(J*H[1]))}}else{if(H[0]==0){A.push(D[0]<x[0]?I[0]+E:I[0]-E)}else{A.push(I[0]+(J*H[0]))}if(H[1]==0){A.push(D[1]<x[1]?I[1]+E:I[1]-E)}else{A.push(I[1]+(J*F[1]))}}return A};var r,m,g,p,o,g,f,t,s,v,e,i,h,l,k;this.compute=function(T,A,N,B,R,y,x,M){x=x||0;v=Math.abs(T[0]-A[0])+x;e=Math.abs(T[1]-A[1])+x;t=Math.min(T[0],A[0])-(x/2);s=Math.min(T[1],A[1])-(x/2);g=T[0]<A[0]?v-(x/2):(x/2);f=T[1]<A[1]?e-(x/2):(x/2);p=T[0]<A[0]?(x/2):v-(x/2);o=T[1]<A[1]?(x/2):e-(x/2);r=q._findControlPoint([g,f],T,A,N,B,R,y);m=q._findControlPoint([p,o],A,T,B,N,y,R);var L=Math.min(g,p),K=Math.min(r[0],m[0]),G=Math.min(L,K),S=Math.max(g,p),P=Math.max(r[0],m[0]),D=Math.max(S,P);if(D>v){v=D}if(G<0){t+=G;var I=Math.abs(G);v+=I;r[0]+=I;g+=I;p+=I;m[0]+=I}var Q=Math.min(f,o),O=Math.min(r[1],m[1]),C=Math.min(Q,O),H=Math.max(f,o),F=Math.max(r[1],m[1]),z=Math.max(H,F);if(z>e){e=z}if(C<0){s+=C;var E=Math.abs(C);e+=E;r[1]+=E;f+=E;o+=E;m[1]+=E}if(M&&v<M){var J=(M-v)/2;v=M;t-=J;g=g+J;p=p+J;r[0]=r[0]+J;m[0]=m[0]+J}if(M&&e<M){var J=(M-e)/2;e=M;s-=J;f=f+J;o=o+J;r[1]=r[1]+J;m[1]=m[1]+J}u=[t,s,v,e,g,f,p,o,r[0],r[1],m[0],m[1]];return u};var d=function(){return[{x:g,y:f},{x:r[0],y:r[1]},{x:m[0],y:m[1]},{x:p,y:o}]};var n=function(y,x,z){if(z){x=jsBezier.locationAlongCurveFrom(y,x>0?0:1,x)}return x};this.pointOnPath=function(x,z){var y=d();x=n(y,x,z);return jsBezier.pointOnCurve(y,x)};this.gradientAtPoint=function(x,z){var y=d();x=n(y,x,z);return jsBezier.gradientAtPoint(y,x)};this.pointAlongPathFrom=function(x,A,z){var y=d();x=n(y,x,z);return jsBezier.pointAlongCurveFrom(y,x,A)}};jsPlumb.Connectors.Flowchart=function(z){this.type="Flowchart";z=z||{};var r=this,e=z.stub||z.minStubLength||30,i=jsPlumbUtil.isArray(e)?e[0]:e,o=jsPlumbUtil.isArray(e)?e[1]:e,t=z.gap||0,u=[],m=0,g=[],q=[],v=[],s,p,y=-Infinity,w=-Infinity,A=Infinity,x=Infinity,d=z.grid,f=function(G,C){var F=G%C,D=Math.floor(G/C),E=F>(C/2)?1:0;return(D+E)*C},n=function(C,F,E,D){return[E||d==null?C:f(C,d[0]),D||d==null?F:f(F,d[1])]},B=function(D,C,H,G){var F=0;for(var E=0;E<u.length;E++){q[E]=u[E][5]/m;g[E]=[F,(F+=(u[E][5]/m))]}},l=function(){v.push(u.length);for(var C=0;C<u.length;C++){v.push(u[C][0]);v.push(u[C][1])}},k=function(L,I,K,J,H,G){var D=u.length==0?K:u[u.length-1][0],C=u.length==0?J:u[u.length-1][1],E=L==D?Infinity:0,F=Math.abs(L==D?I-C:L-D);u.push([L,I,D,C,E,F]);m+=F;y=Math.max(y,L);w=Math.max(w,I);A=Math.min(A,L);x=Math.min(x,I)},h=function(E,G){if(G){E=E>0?E/m:(m+E)/m}var C=g.length-1,D=1;for(var F=0;F<g.length;F++){if(g[F][1]>=E){C=F;D=(E-g[F][0])/q[F];break}}return{segment:u[C],proportion:D,index:C}};this.compute=function(Z,an,C,T,ay,N,X,S,at,ap){u=[];g=[];m=0;q=[];y=w=-Infinity;A=x=Infinity;s=an[0]<Z[0];p=an[1]<Z[1];var ad=X||1,H=(ad/2)+(i+o),E=(ad/2)+(o+i),G=(ad/2)+(i+o),D=(ad/2)+(o+i),Q=ay.orientation||ay.getOrientation(C),az=N.orientation||N.getOrientation(T),am=s?an[0]:Z[0],al=p?an[1]:Z[1],ao=Math.abs(an[0]-Z[0])+H+E,ax=Math.abs(an[1]-Z[1])+G+D;if(Q[0]==0&&Q[1]==0||az[0]==0&&az[1]==0){var af=ao>ax?0:1,ah=[1,0][af];Q=[];az=[];Q[af]=Z[af]>an[af]?-1:1;az[af]=Z[af]>an[af]?1:-1;Q[ah]=0;az[ah]=0}var L=s?(ao-E)+(t*Q[0]):H+(t*Q[0]),K=p?(ax-D)+(t*Q[1]):G+(t*Q[1]),av=s?H+(t*az[0]):(ao-E)+(t*az[0]),au=p?G+(t*az[1]):(ax-D)+(t*az[1]),ac=L+(Q[0]*i),ab=K+(Q[1]*i),O=av+(az[0]*o),M=au+(az[1]*o),Y=Math.abs(L-av)>(i+o),aa=Math.abs(K-au)>(i+o),ak=ac+((O-ac)/2),ai=ab+((M-ab)/2),R=((Q[0]*az[0])+(Q[1]*az[1])),ae=R==-1,ag=R==0,F=R==1;am-=H;al-=G;v=[am,al,ao,ax,L,K,av,au];var ar=[];var V=Q[0]==0?"y":"x",P=ae?"opposite":F?"orthogonal":"perpendicular",I=jsPlumbUtil.segment([L,K],[av,au]),aj=Q[V=="x"?0:1]==-1,U={x:[null,4,3,2,1],y:[null,2,1,4,3]};if(aj){I=U[V][I]}k(ac,ab,L,K,av,au);var W=function(aD,aC,aA,aB){return aD+(aC*((1-aA)*aB)+Math.max(i,o))},J={oppositex:function(){if(C.elementId==T.elementId){var aA=ab+((1-ay.y)*at.height)+Math.max(i,o);return[[ac,aA],[O,aA]]}else{if(Y&&(I==1||I==2)){return[[ak,K],[ak,au]]}else{return[[ac,ai],[O,ai]]}}},orthogonalx:function(){if(I==1||I==2){return[[O,ab]]}else{return[[ac,M]]}},perpendicularx:function(){var aA=(au+K)/2;if((I==1&&az[1]==1)||(I==2&&az[1]==-1)){if(Math.abs(av-L)>Math.max(i,o)){return[[O,ab]]}else{return[[ac,ab],[ac,aA],[O,aA]]}}else{if((I==3&&az[1]==-1)||(I==4&&az[1]==1)){return[[ac,aA],[O,aA]]}else{if((I==3&&az[1]==1)||(I==4&&az[1]==-1)){return[[ac,M]]}else{if((I==1&&az[1]==-1)||(I==2&&az[1]==1)){if(Math.abs(av-L)>Math.max(i,o)){return[[ak,ab],[ak,M]]}else{return[[ac,M]]}}}}}},oppositey:function(){if(C.elementId==T.elementId){var aA=ac+((1-ay.x)*at.width)+Math.max(i,o);return[[aA,ab],[aA,M]]}else{if(aa&&(I==2||I==3)){return[[L,ai],[av,ai]]}else{return[[ak,ab],[ak,M]]}}},orthogonaly:function(){if(I==2||I==3){return[[ac,M]]}else{return[[O,ab]]}},perpendiculary:function(){var aA=(av+L)/2;if((I==2&&az[0]==-1)||(I==3&&az[0]==1)){if(Math.abs(av-L)>Math.max(i,o)){return[[ac,M]]}else{return[[ac,ai],[O,ai]]}}else{if((I==1&&az[0]==-1)||(I==4&&az[0]==1)){var aA=(av+L)/2;return[[aA,ab],[aA,M]]}else{if((I==1&&az[0]==1)||(I==4&&az[0]==-1)){return[[O,ab]]}else{if((I==2&&az[0]==1)||(I==3&&az[0]==-1)){if(Math.abs(au-K)>Math.max(i,o)){return[[ac,ai],[O,ai]]}else{return[[O,ab]]}}}}}}};var aq=J[P+V]();if(aq){for(var aw=0;aw<aq.length;aw++){k(aq[aw][0],aq[aw][1],L,K,av,au)}}k(O,M,L,K,av,au);k(av,au,L,K,av,au);l();B(L,K,av,au);if(w>v[3]){v[3]=w+(X*2)}if(y>v[2]){v[2]=y+(X*2)}return v};this.pointOnPath=function(C,D){return r.pointAlongPathFrom(C,0,D)};this.gradientAtPoint=function(C,D){return u[h(C,D)["index"]][4]};this.pointAlongPathFrom=function(J,C,I){var K=h(J,I),G=K.segment,D=K.proportion,F=u[K.index][5],E=u[K.index][4];var H={x:E==Infinity?G[2]:G[2]>G[0]?G[0]+((1-D)*F)-C:G[2]+(D*F)+C,y:E==0?G[3]:G[3]>G[1]?G[1]+((1-D)*F)-C:G[3]+(D*F)+C,segmentInfo:K};return H}};jsPlumb.Endpoints.Dot=function(e){this.type="Dot";var d=this;e=e||{};this.radius=e.radius||10;this.defaultOffset=0.5*this.radius;this.defaultInnerRadius=this.radius/3;this.compute=function(k,g,m,i){var h=m.radius||d.radius,f=k[0]-h,l=k[1]-h;return[f,l,h*2,h*2,h]}};jsPlumb.Endpoints.Rectangle=function(e){this.type="Rectangle";var d=this;e=e||{};this.width=e.width||20;this.height=e.height||20;this.compute=function(l,h,n,k){var i=n.width||d.width,g=n.height||d.height,f=l[0]-(i/2),m=l[1]-(g/2);return[f,m,i,g]}};var b=function(f){jsPlumb.DOMElementComponent.apply(this,arguments);var d=this;var e=[];this.getDisplayElements=function(){return e};this.appendDisplayElement=function(g){e.push(g)}};jsPlumb.Endpoints.Image=function(i){this.type="Image";b.apply(this,arguments);var n=this,h=false,g=false,f=i.width,e=i.height,l=null,d=i.endpoint;this.img=new Image();n.ready=false;this.img.onload=function(){n.ready=true;f=f||n.img.width;e=e||n.img.height;if(l){l(n)}};d.setImage=function(o,q){var p=o.constructor==String?o:o.src;l=q;n.img.src=o;if(n.canvas!=null){n.canvas.setAttribute("src",o)}};d.setImage(i.src||i.url,i.onload);this.compute=function(q,o,r,p){n.anchorPoint=q;if(n.ready){return[q[0]-f/2,q[1]-e/2,f,e]}else{return[0,0,0,0]}};n.canvas=document.createElement("img"),h=false;n.canvas.style.margin=0;n.canvas.style.padding=0;n.canvas.style.outline=0;n.canvas.style.position="absolute";var k=i.cssClass?" "+i.cssClass:"";n.canvas.className=jsPlumb.endpointClass+k;if(f){n.canvas.setAttribute("width",f)}if(e){n.canvas.setAttribute("height",e)}jsPlumb.appendElement(n.canvas,i.parent);n.attachListeners(n.canvas,n);n.cleanup=function(){g=true};var m=function(r,q,p){if(!g){if(!h){n.canvas.setAttribute("src",n.img.src);n.appendDisplayElement(n.canvas);h=true}var o=n.anchorPoint[0]-(f/2),s=n.anchorPoint[1]-(e/2);jsPlumb.sizeCanvas(n.canvas,o,s,f,e)}};this.paint=function(q,p,o){if(n.ready){m(q,p,o)}else{window.setTimeout(function(){n.paint(q,p,o)},200)}}};jsPlumb.Endpoints.Blank=function(e){var d=this;this.type="Blank";b.apply(this,arguments);this.compute=function(h,f,i,g){return[h[0],h[1],10,0]};d.canvas=document.createElement("div");d.canvas.style.display="block";d.canvas.style.width="1px";d.canvas.style.height="1px";d.canvas.style.background="transparent";d.canvas.style.position="absolute";d.canvas.className=d._jsPlumb.endpointClass;jsPlumb.appendElement(d.canvas,e.parent);this.paint=function(h,g,f){jsPlumb.sizeCanvas(d.canvas,h[0],h[1],h[2],h[3])}};jsPlumb.Endpoints.Triangle=function(d){this.type="Triangle";d=d||{};d.width=d.width||55;d.height=d.height||55;this.width=d.width;this.height=d.height;this.compute=function(k,g,m,i){var h=m.width||self.width,f=m.height||self.height,e=k[0]-(h/2),l=k[1]-(f/2);return[e,l,h,f]}};var c=function(f){var e=true,d=this;this.isAppendedAtTopLevel=true;this.component=f.component;this.loc=f.location==null?0.5:f.location;this.endpointLoc=f.endpointLocation==null?[0.5,0.5]:f.endpointLocation;this.setVisible=function(g){e=g;d.component.repaint()};this.isVisible=function(){return e};this.hide=function(){d.setVisible(false)};this.show=function(){d.setVisible(true)};this.incrementLocation=function(g){d.loc+=g;d.component.repaint()};this.setLocation=function(g){d.loc=g;d.component.repaint()};this.getLocation=function(){return d.loc}};jsPlumb.Overlays.Arrow=function(h){this.type="Arrow";c.apply(this,arguments);this.isAppendedAtTopLevel=false;h=h||{};var e=this;this.length=h.length||20;this.width=h.width||20;this.id=h.id;var g=(h.direction||1)<0?-1:1,f=h.paintStyle||{lineWidth:1},d=h.foldback||0.623;this.computeMaxSize=function(){return e.width*1.5};this.cleanup=function(){};this.draw=function(m,A,v){var p,w,i,q,o;if(m.pointAlongPathFrom){if(jsPlumbUtil.isString(e.loc)||e.loc>1||e.loc<0){var k=parseInt(e.loc);p=m.pointAlongPathFrom(k,g*e.length/2,true),w=m.pointOnPath(k,true),i=jsPlumbUtil.pointOnLine(p,w,e.length)}else{if(e.loc==1){p=m.pointOnPath(e.loc);w=m.pointAlongPathFrom(e.loc,-1);i=jsPlumbUtil.pointOnLine(p,w,e.length)}else{if(e.loc==0){i=m.pointOnPath(e.loc);w=m.pointAlongPathFrom(e.loc,1);p=jsPlumbUtil.pointOnLine(i,w,e.length)}else{p=m.pointAlongPathFrom(e.loc,g*e.length/2),w=m.pointOnPath(e.loc),i=jsPlumbUtil.pointOnLine(p,w,e.length)}}}q=jsPlumbUtil.perpendicularLineTo(p,i,e.width);o=jsPlumbUtil.pointOnLine(p,i,d*e.length);var z=Math.min(p.x,q[0].x,q[1].x),t=Math.max(p.x,q[0].x,q[1].x),y=Math.min(p.y,q[0].y,q[1].y),s=Math.max(p.y,q[0].y,q[1].y);var r={hxy:p,tail:q,cxy:o},u=f.strokeStyle||A.strokeStyle,x=f.fillStyle||A.strokeStyle,n=f.lineWidth||A.lineWidth;e.paint(m,r,n,u,x,v);return[z,t,y,s]}else{return[0,0,0,0]}}};jsPlumb.Overlays.PlainArrow=function(e){e=e||{};var d=jsPlumb.extend(e,{foldback:1});jsPlumb.Overlays.Arrow.call(this,d);this.type="PlainArrow"};jsPlumb.Overlays.Diamond=function(f){f=f||{};var d=f.length||40,e=jsPlumb.extend(f,{length:d/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,e);this.type="Diamond"};var a=function(i){jsPlumb.DOMElementComponent.apply(this,arguments);c.apply(this,arguments);var d=this,e=false;i=i||{};this.id=i.id;var l;var h=function(){l=i.create(i.component);l=jsPlumb.CurrentLibrary.getDOMElement(l);l.style.position="absolute";var m=i._jsPlumb.overlayClass+" "+(d.cssClass?d.cssClass:i.cssClass?i.cssClass:"");l.className=m;jsPlumb.appendElement(l,i.component.parent);i._jsPlumb.getId(l);d.attachListeners(l,d);d.canvas=l};this.getElement=function(){if(l==null){h()}return l};this.getDimensions=function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(d.getElement()))};var f=null,k=function(m){if(f==null){f=d.getDimensions()}return f};this.clearCachedDimensions=function(){f=null};this.computeMaxSize=function(){var m=k();return Math.max(m[0],m[1])};var g=d.setVisible;d.setVisible=function(m){g(m);l.style.display=m?"block":"none"};this.cleanup=function(){if(l!=null){jsPlumb.CurrentLibrary.removeElement(l)}};this.paint=function(m,o,n){if(!e){d.getElement();m.appendDisplayElement(l);d.attachListeners(l,m);e=true}l.style.left=(n[0]+o.minx)+"px";l.style.top=(n[1]+o.miny)+"px"};this.draw=function(n,o,p){var t=k();if(t!=null&&t.length==2){var q={x:0,y:0};if(n.pointOnPath){var r=d.loc,s=false;if(jsPlumbUtil.isString(d.loc)||d.loc<0||d.loc>1){r=parseInt(d.loc);s=true}q=n.pointOnPath(r,s)}else{var m=d.loc.constructor==Array?d.loc:d.endpointLoc;q={x:m[0]*p[2],y:m[1]*p[3]}}minx=q.x-(t[0]/2),miny=q.y-(t[1]/2);d.paint(n,{minx:minx,miny:miny,td:t,cxy:q},p);return[minx,minx+t[0],miny,miny+t[1]]}else{return[0,0,0,0]}};this.reattachListeners=function(m){if(l){d.reattachListenersForElement(l,d,m)}}};jsPlumb.Overlays.Custom=function(d){this.type="Custom";a.apply(this,arguments)};jsPlumb.Overlays.Label=function(h){var d=this;this.labelStyle=h.labelStyle||jsPlumb.Defaults.LabelStyle;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;h.create=function(){return document.createElement("div")};jsPlumb.Overlays.Custom.apply(this,arguments);this.type="Label";var f=h.label||"",d=this,g=null;this.setLabel=function(k){f=k;g=null;d.clearCachedDimensions();e();d.component.repaint()};var e=function(){if(typeof f=="function"){var k=f(d);d.getElement().innerHTML=k.replace(/\r\n/g,"<br/>")}else{if(g==null){g=f;d.getElement().innerHTML=g.replace(/\r\n/g,"<br/>")}}};this.getLabel=function(){return f};var i=this.getDimensions;this.getDimensions=function(){e();return i()}}})();(function(){var c=function(e,g,d,f){this.m=(f-g)/(d-e);this.b=-1*((this.m*e)-g);this.rectIntersect=function(q,p,s,o){var n=[];var k=(p-this.b)/this.m;if(k>=q&&k<=(q+s)){n.push([k,(this.m*k)+this.b])}var t=(this.m*(q+s))+this.b;if(t>=p&&t<=(p+o)){n.push([(t-this.b)/this.m,t])}var k=((p+o)-this.b)/this.m;if(k>=q&&k<=(q+s)){n.push([k,(this.m*k)+this.b])}var t=(this.m*q)+this.b;if(t>=p&&t<=(p+o)){n.push([(t-this.b)/this.m,t])}if(n.length==2){var m=(n[0][0]+n[1][0])/2,l=(n[0][1]+n[1][1])/2;n.push([m,l]);var i=m<=q+(s/2)?-1:1,r=l<=p+(o/2)?-1:1;n.push([i,r]);return n}return null}},a=function(e,g,d,f){if(e<=d&&f<=g){return 1}else{if(e<=d&&g<=f){return 2}else{if(d<=e&&f>=g){return 3}}}return 4},b=function(g,f,i,e,h,m,l,d,k){if(d<=k){return[g,f]}if(i==1){if(e[3]<=0&&h[3]>=1){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]>=1&&h[2]<=0){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(-1*m),f+(-1*l)]}}}else{if(i==2){if(e[3]>=1&&h[3]<=0){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]>=1&&h[2]<=0){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(1*m),f+(-1*l)]}}}else{if(i==3){if(e[3]>=1&&h[3]<=0){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]<=0&&h[2]>=1){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(-1*m),f+(-1*l)]}}}else{if(i==4){if(e[3]<=0&&h[3]>=1){return[g+(e[2]<0.5?-1*m:m),f]}else{if(e[2]<=0&&h[2]>=1){return[g,f+(e[3]<0.5?-1*l:l)]}else{return[g+(1*m),f+(-1*l)]}}}}}}};jsPlumb.Connectors.StateMachine=function(l){var u=this,n=null,o,m,g,e,p=[],d=l.curviness||10,k=l.margin||5,q=l.proximityLimit||80,f=l.orientation&&l.orientation=="clockwise",i=l.loopbackRadius||25,h=false,t=l.showLoopback!==false;this.type="StateMachine";l=l||{};this.compute=function(ad,H,W,I,ac,z,v,U){var Q=Math.abs(ad[0]-H[0]),Y=Math.abs(ad[1]-H[1]),S=0.45*Q,ab=0.45*Y;Q*=1.9;Y*=1.9;v=v||1;var O=Math.min(ad[0],H[0])-S,M=Math.min(ad[1],H[1])-ab;if(!t||(W.elementId!=I.elementId)){h=false;o=ad[0]<H[0]?S:Q-S;m=ad[1]<H[1]?ab:Y-ab;g=ad[0]<H[0]?Q-S:S;e=ad[1]<H[1]?Y-ab:ab;if(ad[2]==0){o-=k}if(ad[2]==1){o+=k}if(ad[3]==0){m-=k}if(ad[3]==1){m+=k}if(H[2]==0){g-=k}if(H[2]==1){g+=k}if(H[3]==0){e-=k}if(H[3]==1){e+=k}var N=(o+g)/2,L=(m+e)/2,A=(-1*N)/L,V=Math.atan(A),P=(A==Infinity||A==-Infinity)?0:Math.abs(d/2*Math.sin(V)),R=(A==Infinity||A==-Infinity)?0:Math.abs(d/2*Math.cos(V)),B=a(o,m,g,e),J=Math.sqrt(Math.pow(g-o,2)+Math.pow(e-m,2));p=b(N,L,B,ad,H,d,d,J,q);var G=Math.max(Math.abs(p[0]-o)*3,Math.abs(p[0]-g)*3,Math.abs(g-o),2*v,U),K=Math.max(Math.abs(p[1]-m)*3,Math.abs(p[1]-e)*3,Math.abs(e-m),2*v,U);if(Q<G){var T=G-Q;O-=(T/2);o+=(T/2);g+=(T/2);Q=G;p[0]+=(T/2)}if(Y<K){var aa=K-Y;M-=(aa/2);m+=(aa/2);e+=(aa/2);Y=K;p[1]+=(aa/2)}n=[O,M,Q,Y,o,m,g,e,p[0],p[1]]}else{h=true;var Z=ad[0],X=ad[0],F=ad[1]-k,D=ad[1]-k,E=Z,C=F-i;Q=((2*v)+(4*i)),Y=((2*v)+(4*i));O=E-i-v-i,M=C-i-v-i;n=[O,M,Q,Y,E-O,C-M,i,f,Z-O,F-M,X-O,D-M]}return n};var r=function(){return[{x:g,y:e},{x:p[0],y:p[1]},{x:p[0]+1,y:p[1]+1},{x:o,y:m}]};var s=function(w,v,x){if(x){v=jsBezier.locationAlongCurveFrom(w,v>0?0:1,v)}return v};this.pointOnPath=function(x,B){if(h){if(B){var y=Math.PI*2*i;x=x/y}if(x>0&&x<1){x=1-x}var z=(x*2*Math.PI)+(Math.PI/2),w=n[4]+(n[6]*Math.cos(z)),v=n[5]+(n[6]*Math.sin(z));return{x:w,y:v}}else{var A=r();x=s(A,x,B);return jsBezier.pointOnCurve(A,x)}};this.gradientAtPoint=function(v,y){if(h){if(y){var w=Math.PI*2*i;v=v/w}return Math.atan(v*2*Math.PI)}else{var x=r();v=s(x,v,y);return jsBezier.gradientAtPoint(x,v)}};this.pointAlongPathFrom=function(D,v,C){if(h){if(C){var B=Math.PI*2*i;D=D/B}if(D>0&&D<1){D=1-D}var B=2*Math.PI*n[6],w=v/B*2*Math.PI,z=(D*2*Math.PI)-w+(Math.PI/2),y=n[4]+(n[6]*Math.cos(z)),x=n[5]+(n[6]*Math.sin(z));return{x:y,y:x}}else{var A=r();D=s(A,D,C);return jsBezier.pointAlongCurveFrom(A,D,v)}}};jsPlumb.Connectors.canvas.StateMachine=function(f){f=f||{};var d=this,g=f.drawGuideline||true,e=f.avoidSelector;jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.CanvasConnector.apply(this,arguments);this._paint=function(l){if(l.length==10){d.ctx.beginPath();d.ctx.moveTo(l[4],l[5]);d.ctx.bezierCurveTo(l[8],l[9],l[8],l[9],l[6],l[7]);d.ctx.stroke()}else{d.ctx.save();d.ctx.beginPath();var k=0,i=2*Math.PI,h=l[7];d.ctx.arc(l[4],l[5],l[6],0,i,h);d.ctx.stroke();d.ctx.closePath();d.ctx.restore()}};this.createGradient=function(i,h){return h.createLinearGradient(i[4],i[5],i[6],i[7])}};jsPlumb.Connectors.svg.StateMachine=function(){var d=this;jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.SvgConnector.apply(this,arguments);this.getPath=function(e){if(e.length==10){return"M "+e[4]+" "+e[5]+" C "+e[8]+" "+e[9]+" "+e[8]+" "+e[9]+" "+e[6]+" "+e[7]}else{return"M"+(e[8]+4)+" "+e[9]+" A "+e[6]+" "+e[6]+" 0 1,0 "+(e[8]-4)+" "+e[9]}}};jsPlumb.Connectors.vml.StateMachine=function(){jsPlumb.Connectors.StateMachine.apply(this,arguments);jsPlumb.VmlConnector.apply(this,arguments);var d=jsPlumb.vml.convertValue;this.getPath=function(k){if(k.length==10){return"m"+d(k[4])+","+d(k[5])+" c"+d(k[8])+","+d(k[9])+","+d(k[8])+","+d(k[9])+","+d(k[6])+","+d(k[7])+" e"}else{var h=d(k[8]-k[6]),g=d(k[9]-(2*k[6])),f=h+d(2*k[6]),e=g+d(2*k[6]),l=h+","+g+","+f+","+e;var i="ar "+l+","+d(k[8])+","+d(k[9])+","+d(k[8])+","+d(k[9])+" e";return i}}}})();(function(){var h={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},c=null;if(document.createStyleSheet&&document.namespaces){var m=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],g="behavior:url(#default#VML);position:absolute;";c=document.createStyleSheet();for(var r=0;r<m.length;r++){c.addRule(m[r],g)}document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var t=1000,s={},a=function(u,i){var w=jsPlumb.getId(u),v=s[w];if(!v){v=f("group",[0,0,t,t],{"class":i});v.style.backgroundColor="red";s[w]=v;jsPlumb.appendElement(v,u)}return v},e=function(v,w){for(var u in w){v[u]=w[u]}},f=function(u,y,z,w,i,v){z=z||{};var x=document.createElement("jsplumb:"+u);if(v){i.appendElement(x,w)}else{jsPlumb.CurrentLibrary.appendElement(x,w)}x.className=(z["class"]?z["class"]+" ":"")+"jsplumb_vml";k(x,y);e(x,z);return x},k=function(u,i,v){u.style.left=i[0]+"px";u.style.top=i[1]+"px";u.style.width=i[2]+"px";u.style.height=i[3]+"px";u.style.position="absolute";if(v){u.style.zIndex=v}},p=jsPlumb.vml.convertValue=function(i){return Math.floor(i*t)},b=function(w,u,v,i){if("transparent"===u){i.setOpacity(v,"0.0")}else{i.setOpacity(v,"1.0")}},q=function(y,u,B,C){var x={};if(u.strokeStyle){x.stroked="true";var D=jsPlumbUtil.convertStyle(u.strokeStyle,true);x.strokecolor=D;b(x,D,"stroke",B);x.strokeweight=u.lineWidth+"px"}else{x.stroked="false"}if(u.fillStyle){x.filled="true";var v=jsPlumbUtil.convertStyle(u.fillStyle,true);x.fillcolor=v;b(x,v,"fill",B)}else{x.filled="false"}if(u.dashstyle){if(B.strokeNode==null){B.strokeNode=f("stroke",[0,0,0,0],{dashstyle:u.dashstyle},y,C)}else{B.strokeNode.dashstyle=u.dashstyle}}else{if(u["stroke-dasharray"]&&u.lineWidth){var E=u["stroke-dasharray"].indexOf(",")==-1?" ":",",z=u["stroke-dasharray"].split(E),w="";for(var A=0;A<z.length;A++){w+=(Math.floor(z[A]/u.lineWidth)+E)}if(B.strokeNode==null){B.strokeNode=f("stroke",[0,0,0,0],{dashstyle:w},y,C)}else{B.strokeNode.dashstyle=w}}}e(y,x)},n=function(){var i=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.opacityNodes={stroke:null,fill:null};this.initOpacityNodes=function(v){i.opacityNodes.stroke=f("stroke",[0,0,1,1],{opacity:"0.0"},v,i._jsPlumb);i.opacityNodes.fill=f("fill",[0,0,1,1],{opacity:"0.0"},v,i._jsPlumb)};this.setOpacity=function(v,x){var w=i.opacityNodes[v];if(w){w.opacity=""+x}};var u=[];this.getDisplayElements=function(){return u};this.appendDisplayElement=function(w,v){if(!v){i.canvas.parentNode.appendChild(w)}u.push(w)}},d=jsPlumb.VmlConnector=function(v){var i=this;i.strokeNode=null;i.canvas=null;n.apply(this,arguments);var u=i._jsPlumb.connectorClass+(v.cssClass?(" "+v.cssClass):"");this.paint=function(A,x,z){if(x!=null){var E=i.getPath(A),y={path:E};if(x.outlineColor){var C=x.outlineWidth||1,D=x.lineWidth+(2*C),B={strokeStyle:jsPlumbUtil.convertStyle(x.outlineColor),lineWidth:D};for(var w in h){B[w]=x[w]}if(i.bgCanvas==null){y["class"]=u;y.coordsize=(A[2]*t)+","+(A[3]*t);i.bgCanvas=f("shape",A,y,v.parent,i._jsPlumb,true);k(i.bgCanvas,A,i.getZIndex());i.appendDisplayElement(i.bgCanvas,true);i.attachListeners(i.bgCanvas,i);i.initOpacityNodes(i.bgCanvas,["stroke"])}else{y.coordsize=(A[2]*t)+","+(A[3]*t);k(i.bgCanvas,A,i.getZIndex());e(i.bgCanvas,y)}q(i.bgCanvas,B,i)}if(i.canvas==null){y["class"]=u;y.coordsize=(A[2]*t)+","+(A[3]*t);if(i.tooltip){y.label=i.tooltip}i.canvas=f("shape",A,y,v.parent,i._jsPlumb,true);i.appendDisplayElement(i.canvas,true);i.attachListeners(i.canvas,i);i.initOpacityNodes(i.canvas,["stroke"])}else{y.coordsize=(A[2]*t)+","+(A[3]*t);k(i.canvas,A,i.getZIndex());e(i.canvas,y)}q(i.canvas,x,i,i._jsPlumb)}};this.reattachListeners=function(){if(i.canvas){i.reattachListenersForElement(i.canvas,i)}}},l=window.VmlEndpoint=function(y){n.apply(this,arguments);var i=null,v=this,u=null,x=null;v.canvas=document.createElement("div");v.canvas.style.position="absolute";var w=v._jsPlumb.endpointClass+(y.cssClass?(" "+y.cssClass):"");y._jsPlumb.appendElement(v.canvas,y.parent);if(v.tooltip){v.canvas.setAttribute("label",v.tooltip)}this.paint=function(C,A,z){var B={};jsPlumb.sizeCanvas(v.canvas,C[0],C[1],C[2],C[3]);if(i==null){B["class"]=w;i=v.getVml([0,0,C[2],C[3]],B,z,v.canvas,v._jsPlumb);v.attachListeners(i,v);v.appendDisplayElement(i,true);v.appendDisplayElement(v.canvas,true);v.initOpacityNodes(i,["fill"])}else{k(i,[0,0,C[2],C[3]]);e(i,B)}q(i,A,v)};this.reattachListeners=function(){if(i){v.reattachListenersForElement(i,v)}}};jsPlumb.Connectors.vml.Bezier=function(){jsPlumb.Connectors.Bezier.apply(this,arguments);d.apply(this,arguments);this.getPath=function(i){return"m"+p(i[4])+","+p(i[5])+" c"+p(i[8])+","+p(i[9])+","+p(i[10])+","+p(i[11])+","+p(i[6])+","+p(i[7])+" e"}};jsPlumb.Connectors.vml.Straight=function(){jsPlumb.Connectors.Straight.apply(this,arguments);d.apply(this,arguments);this.getPath=function(i){return"m"+p(i[4])+","+p(i[5])+" l"+p(i[6])+","+p(i[7])+" e"}};jsPlumb.Connectors.vml.Flowchart=function(){jsPlumb.Connectors.Flowchart.apply(this,arguments);d.apply(this,arguments);this.getPath=function(v){var w="m "+p(v[4])+","+p(v[5])+" l";for(var u=0;u<v[8];u++){w=w+" "+p(v[9+(u*2)])+","+p(v[10+(u*2)])}w=w+" "+p(v[6])+","+p(v[7])+" e";return w}};jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);l.apply(this,arguments);this.getVml=function(w,x,u,v,i){return f("oval",w,x,v,i)}};jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);l.apply(this,arguments);this.getVml=function(w,x,u,v,i){return f("rect",w,x,v,i)}};jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var o=function(x,v){x.apply(this,v);n.apply(this,v);var u=this,w=null;u.canvas=null;u.isAppendedAtTopLevel=true;var i=function(z,y){return"m "+p(z.hxy.x)+","+p(z.hxy.y)+" l "+p(z.tail[0].x)+","+p(z.tail[0].y)+" "+p(z.cxy.x)+","+p(z.cxy.y)+" "+p(z.tail[1].x)+","+p(z.tail[1].y)+" x e"};this.paint=function(B,G,F,H,L,K){var z={};if(H){z.stroked="true";z.strokecolor=jsPlumbUtil.convertStyle(H,true)}if(F){z.strokeweight=F+"px"}if(L){z.filled="true";z.fillcolor=L}var y=Math.min(G.hxy.x,G.tail[0].x,G.tail[1].x,G.cxy.x),J=Math.min(G.hxy.y,G.tail[0].y,G.tail[1].y,G.cxy.y),C=Math.max(G.hxy.x,G.tail[0].x,G.tail[1].x,G.cxy.x),A=Math.max(G.hxy.y,G.tail[0].y,G.tail[1].y,G.cxy.y),I=Math.abs(C-y),E=Math.abs(A-J),D=[y,J,I,E];z.path=i(G,K);z.coordsize=(K[2]*t)+","+(K[3]*t);D[0]=K[0];D[1]=K[1];D[2]=K[2];D[3]=K[3];if(u.canvas==null){u.canvas=f("shape",D,z,B.canvas.parentNode,B._jsPlumb,true);B.appendDisplayElement(u.canvas,true);u.attachListeners(u.canvas,B);u.attachListeners(u.canvas,u)}else{k(u.canvas,D);e(u.canvas,z)}};this.reattachListeners=function(){if(u.canvas){u.reattachListenersForElement(u.canvas,u)}};this.cleanup=function(){if(u.canvas!=null){jsPlumb.CurrentLibrary.removeElement(u.canvas)}}};jsPlumb.Overlays.vml.Arrow=function(){o.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.vml.PlainArrow=function(){o.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.vml.Diamond=function(){o.apply(this,[jsPlumb.Overlays.Diamond,arguments])}})();(function(){var l={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},w="stroke-dasharray",A="dashstyle",e="linearGradient",b="radialGradient",c="fill",a="stop",z="stroke",q="stroke-width",h="style",m="none",t="jsplumb_gradient_",o="lineWidth",C={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},g=function(F,D){for(var E in D){F.setAttribute(E,""+D[E])}},f=function(E,D){var F=document.createElementNS(C.svg,E);D=D||{};D.version="1.1";D.xmlns=C.xhtml;g(F,D);return F},n=function(D){return"position:absolute;left:"+D[0]+"px;top:"+D[1]+"px"},i=function(E){for(var D=0;D<E.childNodes.length;D++){if(E.childNodes[D].tagName==e||E.childNodes[D].tagName==b){E.removeChild(E.childNodes[D])}}},v=function(N,I,F,D,J){var G=t+J._jsPlumb.idstamp();i(N);if(!F.gradient.offset){var L=f(e,{id:G,gradientUnits:"userSpaceOnUse"});N.appendChild(L)}else{var L=f(b,{id:G});N.appendChild(L)}for(var K=0;K<F.gradient.stops.length;K++){var H=K;if(D.length==8){H=D[4]<D[6]?K:F.gradient.stops.length-1-K}else{H=D[4]<D[6]?F.gradient.stops.length-1-K:K}var M=jsPlumbUtil.convertStyle(F.gradient.stops[H][1],true);var O=f(a,{offset:Math.floor(F.gradient.stops[K][0]*100)+"%","stop-color":M});L.appendChild(O)}var E=F.strokeStyle?z:c;I.setAttribute(h,E+":url(#"+G+")")},x=function(K,G,E,D,H){if(E.gradient){v(K,G,E,D,H)}else{i(K);G.setAttribute(h,"")}G.setAttribute(c,E.fillStyle?jsPlumbUtil.convertStyle(E.fillStyle,true):m);G.setAttribute(z,E.strokeStyle?jsPlumbUtil.convertStyle(E.strokeStyle,true):m);if(E.lineWidth){G.setAttribute(q,E.lineWidth)}if(E[A]&&E[o]&&!E[w]){var L=E[A].indexOf(",")==-1?" ":",",I=E[A].split(L),F="";I.forEach(function(M){F+=(Math.floor(M*E.lineWidth)+L)});G.setAttribute(w,F)}else{if(E[w]){G.setAttribute(w,E[w])}}for(var J in l){if(E[J]){G.setAttribute(l[J],E[J])}}},B=function(F){var D=/([0-9].)(p[xt])\s(.*)/;var E=F.match(D);return{size:E[1]+E[2],font:E[3]}},r=function(I,J,E){var K=E.split(" "),H=I.className,G=H.baseVal.split(" ");for(var F=0;F<K.length;F++){if(J){if(G.indexOf(K[F])==-1){G.push(K[F])}}else{var D=G.indexOf(K[F]);if(D!=-1){G.splice(D,1)}}}I.className.baseVal=G.join(" ")},u=function(E,D){r(E,true,D)},k=function(E,D){r(E,false,D)};jsPlumbUtil.svg={addClass:u,removeClass:k,node:f,attr:g,pos:n};var s=function(H){var D=this,G=H.pointerEventsSpec||"all";jsPlumb.jsPlumbUIComponent.apply(this,H.originalArgs);D.canvas=null,D.path=null,D.svg=null;var F=H.cssClass+" "+(H.originalArgs[0].cssClass||""),I={style:"",width:0,height:0,"pointer-events":G,position:"absolute"};if(D.tooltip){I.title=D.tooltip}D.svg=f("svg",I);if(H.useDivWrapper){D.canvas=document.createElement("div");D.canvas.style.position="absolute";jsPlumb.sizeCanvas(D.canvas,0,0,1,1);D.canvas.className=F;if(D.tooltip){D.canvas.setAttribute("title",D.tooltip)}}else{g(D.svg,{"class":F});D.canvas=D.svg}H._jsPlumb.appendElement(D.canvas,H.originalArgs[0]["parent"]);if(H.useDivWrapper){D.canvas.appendChild(D.svg)}var E=[D.canvas];this.getDisplayElements=function(){return E};this.appendDisplayElement=function(J){E.push(J)};this.paint=function(N,L,K){if(L!=null){var J=N[0],O=N[1];if(H.useDivWrapper){jsPlumb.sizeCanvas(D.canvas,N[0],N[1],N[2],N[3]);J=0,O=0}var M=n([J,O,N[2],N[3]]);if(D.getZIndex()){M+=";z-index:"+D.getZIndex()+";"}g(D.svg,{style:M,width:N[2],height:N[3]});D._paint.apply(this,arguments)}}};var d=jsPlumb.SvgConnector=function(E){var D=this;s.apply(this,[{cssClass:E._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",tooltip:E.tooltip,_jsPlumb:E._jsPlumb}]);this._paint=function(L,H){var K=D.getPath(L),F={d:K},J=null;F["pointer-events"]="all";if(H.outlineColor){var I=H.outlineWidth||1,G=H.lineWidth+(2*I),J=jsPlumb.CurrentLibrary.extend({},H);J.strokeStyle=jsPlumbUtil.convertStyle(H.outlineColor);J.lineWidth=G;if(D.bgPath==null){D.bgPath=f("path",F);D.svg.appendChild(D.bgPath);D.attachListeners(D.bgPath,D)}else{g(D.bgPath,F)}x(D.svg,D.bgPath,J,L,D)}if(D.path==null){D.path=f("path",F);D.svg.appendChild(D.path);D.attachListeners(D.path,D)}else{g(D.path,F)}x(D.svg,D.path,H,L,D)};this.reattachListeners=function(){if(D.bgPath){D.reattachListenersForElement(D.bgPath,D)}if(D.path){D.reattachListenersForElement(D.path,D)}}};jsPlumb.Connectors.svg.Bezier=function(D){jsPlumb.Connectors.Bezier.apply(this,arguments);d.apply(this,arguments);this.getPath=function(F){var E="M "+F[4]+" "+F[5];E+=(" C "+F[8]+" "+F[9]+" "+F[10]+" "+F[11]+" "+F[6]+" "+F[7]);return E}};jsPlumb.Connectors.svg.Straight=function(D){jsPlumb.Connectors.Straight.apply(this,arguments);d.apply(this,arguments);this.getPath=function(E){return"M "+E[4]+" "+E[5]+" L "+E[6]+" "+E[7]}};jsPlumb.Connectors.svg.Flowchart=function(){var D=this;jsPlumb.Connectors.Flowchart.apply(this,arguments);d.apply(this,arguments);this.getPath=function(F){var G="M "+F[4]+","+F[5];for(var E=0;E<F[8];E++){G=G+" L "+F[9+(E*2)]+" "+F[10+(E*2)]}G=G+" "+F[6]+","+F[7];return G}};var y=window.SvgEndpoint=function(E){var D=this;s.apply(this,[{cssClass:E._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:true,_jsPlumb:E._jsPlumb}]);this._paint=function(H,G){var F=jsPlumb.extend({},G);if(F.outlineColor){F.strokeWidth=F.outlineWidth;F.strokeStyle=jsPlumbUtil.convertStyle(F.outlineColor,true)}if(D.node==null){D.node=D.makeNode(H,F);D.svg.appendChild(D.node);D.attachListeners(D.node,D)}x(D.svg,D.node,F,H,D);n(D.node,H)};this.reattachListeners=function(){if(D.node){D.reattachListenersForElement(D.node,D)}}};jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);y.apply(this,arguments);this.makeNode=function(E,D){return f("circle",{cx:E[2]/2,cy:E[3]/2,r:E[2]/2})}};jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);y.apply(this,arguments);this.makeNode=function(E,D){return f("rect",{width:E[2],height:E[3]})}};jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var p=function(H,F){H.apply(this,F);jsPlumb.jsPlumbUIComponent.apply(this,F);this.isAppendedAtTopLevel=false;var D=this,G=null;this.paint=function(J,M,I,N,K){if(G==null){G=f("path",{"pointer-events":"all"});J.svg.appendChild(G);D.attachListeners(G,J);D.attachListeners(G,D)}var L=F&&(F.length==1)?(F[0].cssClass||""):"";g(G,{d:E(M),"class":L,stroke:N?N:null,fill:K?K:null})};var E=function(I){return"M"+I.hxy.x+","+I.hxy.y+" L"+I.tail[0].x+","+I.tail[0].y+" L"+I.cxy.x+","+I.cxy.y+" L"+I.tail[1].x+","+I.tail[1].y+" L"+I.hxy.x+","+I.hxy.y};this.reattachListeners=function(){if(G){D.reattachListenersForElement(G,D)}};this.cleanup=function(){if(G!=null){jsPlumb.CurrentLibrary.removeElement(G)}}};jsPlumb.Overlays.svg.Arrow=function(){p.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.svg.PlainArrow=function(){p.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.svg.Diamond=function(){p.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumb.Overlays.svg.GuideLines=function(){var I=null,D=this,H=null,G,F;jsPlumb.Overlays.GuideLines.apply(this,arguments);this.paint=function(K,M,J,N,L){if(I==null){I=f("path");K.svg.appendChild(I);D.attachListeners(I,K);D.attachListeners(I,D);G=f("path");K.svg.appendChild(G);D.attachListeners(G,K);D.attachListeners(G,D);F=f("path");K.svg.appendChild(F);D.attachListeners(F,K);D.attachListeners(F,D)}g(I,{d:E(M[0],M[1]),stroke:"red",fill:null});g(G,{d:E(M[2][0],M[2][1]),stroke:"blue",fill:null});g(F,{d:E(M[3][0],M[3][1]),stroke:"green",fill:null})};var E=function(K,J){return"M "+K.x+","+K.y+" L"+J.x+","+J.y}}})();(function(){var d=null,i=function(p,o){return jsPlumb.CurrentLibrary.hasClass(a(p),o)},a=function(o){return jsPlumb.CurrentLibrary.getElementObject(o)},m=function(o){return jsPlumb.CurrentLibrary.getOffset(a(o))},n=function(o){return jsPlumb.CurrentLibrary.getPageXY(o)},f=function(o){return jsPlumb.CurrentLibrary.getClientXY(o)};var k=function(){var q=this;q.overlayPlacements=[];jsPlumb.jsPlumbUIComponent.apply(this,arguments);jsPlumbUtil.EventGenerator.apply(this,arguments);this._over=function(z){var B=m(a(q.canvas)),D=n(z),u=D[0]-B.left,C=D[1]-B.top;if(u>0&&C>0&&u<q.canvas.width&&C<q.canvas.height){for(var v=0;v<q.overlayPlacements.length;v++){var w=q.overlayPlacements[v];if(w&&(w[0]<=u&&w[1]>=u&&w[2]<=C&&w[3]>=C)){return true}}var A=q.canvas.getContext("2d").getImageData(parseInt(u),parseInt(C),1,1);return A.data[0]!=0||A.data[1]!=0||A.data[2]!=0||A.data[3]!=0}return false};var p=false,o=false,t=null,s=false,r=function(v,u){return v!=null&&i(v,u)};this.mousemove=function(x){var z=n(x),w=f(x),v=document.elementFromPoint(w[0],w[1]),y=r(v,"_jsPlumb_overlay");var u=d==null&&(r(v,"_jsPlumb_endpoint")||r(v,"_jsPlumb_connector"));if(!p&&u&&q._over(x)){p=true;q.fire("mouseenter",q,x);return true}else{if(p&&(!q._over(x)||!u)&&!y){p=false;q.fire("mouseexit",q,x)}}q.fire("mousemove",q,x)};this.click=function(u){if(p&&q._over(u)&&!s){q.fire("click",q,u)}s=false};this.dblclick=function(u){if(p&&q._over(u)&&!s){q.fire("dblclick",q,u)}s=false};this.mousedown=function(u){if(q._over(u)&&!o){o=true;t=m(a(q.canvas));q.fire("mousedown",q,u)}};this.mouseup=function(u){o=false;q.fire("mouseup",q,u)};this.contextmenu=function(u){if(p&&q._over(u)&&!s){q.fire("contextmenu",q,u)}s=false}};var c=function(p){var o=document.createElement("canvas");p._jsPlumb.appendElement(o,p.parent);o.style.position="absolute";if(p["class"]){o.className=p["class"]}p._jsPlumb.getId(o,p.uuid);if(p.tooltip){o.setAttribute("title",p.tooltip)}return o};var l=function(p){k.apply(this,arguments);var o=[];this.getDisplayElements=function(){return o};this.appendDisplayElement=function(q){o.push(q)}};var h=jsPlumb.CanvasConnector=function(r){l.apply(this,arguments);var o=function(v,t){p.ctx.save();jsPlumb.extend(p.ctx,t);if(t.gradient){var u=p.createGradient(v,p.ctx);for(var s=0;s<t.gradient.stops.length;s++){u.addColorStop(t.gradient.stops[s][0],t.gradient.stops[s][1])}p.ctx.strokeStyle=u}p._paint(v,t);p.ctx.restore()};var p=this,q=p._jsPlumb.connectorClass+" "+(r.cssClass||"");p.canvas=c({"class":q,_jsPlumb:p._jsPlumb,parent:r.parent,tooltip:r.tooltip});p.ctx=p.canvas.getContext("2d");p.appendDisplayElement(p.canvas);p.paint=function(w,t){if(t!=null){jsPlumb.sizeCanvas(p.canvas,w[0],w[1],w[2],w[3]);if(p.getZIndex()){p.canvas.style.zIndex=p.getZIndex()}if(t.outlineColor!=null){var v=t.outlineWidth||1,s=t.lineWidth+(2*v),u={strokeStyle:t.outlineColor,lineWidth:s};o(w,u)}o(w,t)}}};var b=function(r){var p=this;l.apply(this,arguments);var q=p._jsPlumb.endpointClass+" "+(r.cssClass||""),o={"class":q,_jsPlumb:p._jsPlumb,parent:r.parent,tooltip:p.tooltip};p.canvas=c(o);p.ctx=p.canvas.getContext("2d");p.appendDisplayElement(p.canvas);this.paint=function(x,u,s){jsPlumb.sizeCanvas(p.canvas,x[0],x[1],x[2],x[3]);if(u.outlineColor!=null){var w=u.outlineWidth||1,t=u.lineWidth+(2*w);var v={strokeStyle:u.outlineColor,lineWidth:t}}p._paint.apply(this,arguments)}};jsPlumb.Endpoints.canvas.Dot=function(r){jsPlumb.Endpoints.Dot.apply(this,arguments);b.apply(this,arguments);var q=this,p=function(s){try{return parseInt(s)}catch(t){if(s.substring(s.length-1)=="%"){return parseInt(s.substring(0,s-1))}}},o=function(u){var s=q.defaultOffset,t=q.defaultInnerRadius;u.offset&&(s=p(u.offset));u.innerRadius&&(t=p(u.innerRadius));return[s,t]};this._paint=function(A,t,x){if(t!=null){var B=q.canvas.getContext("2d"),u=x.getOrientation(q);jsPlumb.extend(B,t);if(t.gradient){var v=o(t.gradient),y=u[1]==1?v[0]*-1:v[0],s=u[0]==1?v[0]*-1:v[0],z=B.createRadialGradient(A[4],A[4],A[4],A[4]+s,A[4]+y,v[1]);for(var w=0;w<t.gradient.stops.length;w++){z.addColorStop(t.gradient.stops[w][0],t.gradient.stops[w][1])}B.fillStyle=z}B.beginPath();B.arc(A[4],A[4],A[4],0,Math.PI*2,true);B.closePath();if(t.fillStyle||t.gradient){B.fill()}if(t.strokeStyle){B.stroke()}}}};jsPlumb.Endpoints.canvas.Rectangle=function(p){var o=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments);b.apply(this,arguments);this._paint=function(x,r,v){var A=o.canvas.getContext("2d"),t=v.getOrientation(o);jsPlumb.extend(A,r);if(r.gradient){var z=t[1]==1?x[3]:t[1]==0?x[3]/2:0;var y=t[1]==-1?x[3]:t[1]==0?x[3]/2:0;var s=t[0]==1?x[2]:t[0]==0?x[2]/2:0;var q=t[0]==-1?x[2]:t[0]==0?x[2]/2:0;var w=A.createLinearGradient(s,z,q,y);for(var u=0;u<r.gradient.stops.length;u++){w.addColorStop(r.gradient.stops[u][0],r.gradient.stops[u][1])}A.fillStyle=w}A.beginPath();A.rect(0,0,x[2],x[3]);A.closePath();if(r.fillStyle||r.gradient){A.fill()}if(r.strokeStyle){A.stroke()}}};jsPlumb.Endpoints.canvas.Triangle=function(p){var o=this;jsPlumb.Endpoints.Triangle.apply(this,arguments);b.apply(this,arguments);this._paint=function(z,q,v){var s=z[2],C=z[3],B=z[0],A=z[1],D=o.canvas.getContext("2d"),w=0,u=0,t=0,r=v.getOrientation(o);if(r[0]==1){w=s;u=C;t=180}if(r[1]==-1){w=s;t=90}if(r[1]==1){u=C;t=-90}D.fillStyle=q.fillStyle;D.translate(w,u);D.rotate(t*Math.PI/180);D.beginPath();D.moveTo(0,0);D.lineTo(s/2,C/2);D.lineTo(0,C);D.closePath();if(q.fillStyle||q.gradient){D.fill()}if(q.strokeStyle){D.stroke()}}};jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Connectors.canvas.Bezier=function(){var o=this;jsPlumb.Connectors.Bezier.apply(this,arguments);h.apply(this,arguments);this._paint=function(q,p){o.ctx.beginPath();o.ctx.moveTo(q[4],q[5]);o.ctx.bezierCurveTo(q[8],q[9],q[10],q[11],q[6],q[7]);o.ctx.stroke()};this.createGradient=function(r,p,q){return o.ctx.createLinearGradient(r[6],r[7],r[4],r[5])}};jsPlumb.Connectors.canvas.Straight=function(){var p=this,o=[null,[1,-1],[1,1],[-1,1],[-1,-1]];jsPlumb.Connectors.Straight.apply(this,arguments);h.apply(this,arguments);this._paint=function(r,t){p.ctx.beginPath();if(t.dashstyle&&t.dashstyle.split(" ").length==2){var v=t.dashstyle.split(" ");if(v.length!=2){v=[2,2]}var C=[v[0]*t.lineWidth,v[1]*t.lineWidth],y=(r[6]-r[4])/(r[7]-r[5]),G=jsPlumbUtil.segment([r[4],r[5]],[r[6],r[7]]),x=o[G],u=Math.atan(y),z=Math.sqrt(Math.pow(r[6]-r[4],2)+Math.pow(r[7]-r[5],2)),B=Math.floor(z/(C[0]+C[1])),w=[r[4],r[5]];for(var A=0;A<B;A++){p.ctx.moveTo(w[0],w[1]);var q=w[0]+(Math.abs(Math.sin(u)*C[0])*x[0]),F=w[1]+(Math.abs(Math.cos(u)*C[0])*x[1]),E=w[0]+(Math.abs(Math.sin(u)*(C[0]+C[1]))*x[0]),D=w[1]+(Math.abs(Math.cos(u)*(C[0]+C[1]))*x[1]);p.ctx.lineTo(q,F);w=[E,D]}p.ctx.moveTo(w[0],w[1]);p.ctx.lineTo(r[6],r[7])}else{p.ctx.moveTo(r[4],r[5]);p.ctx.lineTo(r[6],r[7])}p.ctx.stroke()};this.createGradient=function(r,q){return q.createLinearGradient(r[4],r[5],r[6],r[7])}};jsPlumb.Connectors.canvas.Flowchart=function(){var o=this;jsPlumb.Connectors.Flowchart.apply(this,arguments);h.apply(this,arguments);this._paint=function(r,q){o.ctx.beginPath();o.ctx.moveTo(r[4],r[5]);for(var p=0;p<r[8];p++){o.ctx.lineTo(r[9+(p*2)],r[10+(p*2)])}o.ctx.lineTo(r[6],r[7]);o.ctx.stroke()};this.createGradient=function(q,p){return p.createLinearGradient(q[4],q[5],q[6],q[7])}};jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;var g=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)};var e=function(p,o){p.apply(this,o);g.apply(this,o);this.paint=function(s,u,q,v,t){var r=s.ctx;r.lineWidth=q;r.beginPath();r.moveTo(u.hxy.x,u.hxy.y);r.lineTo(u.tail[0].x,u.tail[0].y);r.lineTo(u.cxy.x,u.cxy.y);r.lineTo(u.tail[1].x,u.tail[1].y);r.lineTo(u.hxy.x,u.hxy.y);r.closePath();if(v){r.strokeStyle=v;r.stroke()}if(t){r.fillStyle=t;r.fill()}}};jsPlumb.Overlays.canvas.Arrow=function(){e.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumb.Overlays.canvas.PlainArrow=function(){e.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumb.Overlays.canvas.Diamond=function(){e.apply(this,[jsPlumb.Overlays.Diamond,arguments])}})();(function(){var d=new Class({Extends:Fx.Morph,onStep:null,initialize:function(m,l){this.parent(m,l);if(l.onStep){this.onStep=l.onStep}},step:function(l){this.parent(l);if(this.onStep){try{this.onStep()}catch(m){}}}});var b={},i={},h={},k={},f={};var e=function(n,p,o,l){if(p){var q=p.get("id");if(q){var m=i[q];if(m){if(m[o]){m[o](n,p,l)}}}}};var g=function(m,o){if(m){var n=m.get("id");if(n){var l=i[n];if(l){if(l.hoverClass){if(o){m.addClass(l.hoverClass)}else{m.removeClass(l.hoverClass)}}}}}};var c=function(p,m,o){var n=p[m];if(!n){n=[];p[m]=n}n.push(o)};var a=function(l){return $(l)};jsPlumb.CurrentLibrary={addClass:function(m,l){m=jsPlumb.CurrentLibrary.getElementObject(m);try{if(m.className.constructor==SVGAnimatedString){jsPlumbUtil.svg.addClass(m,l)}else{m.addClass(l)}}catch(n){m.addClass(l)}},animate:function(p,o,n){var l=new d(p,n);l.start(o)},appendElement:function(m,l){a(l).grab(m)},bind:function(l,m,n){l=a(l);l.addEvent(m,n)},dragEvents:{start:"onStart",stop:"onComplete",drag:"onDrag",step:"onStep",over:"onEnter",out:"onLeave",drop:"onDrop",complete:"onComplete"},extend:function(m,l){return $extend(m,l)},getAttribute:function(l,m){return l.get(m)},getClientXY:function(l){return[l.event.clientX,l.event.clientY]},getDragObject:function(l){return l[0]},getDragScope:function(m){var n=jsPlumb.getId(m),l=k[n];return l[0].scope},getDropEvent:function(l){return l[2]},getDropScope:function(l){var m=jsPlumb.getId(l);return f[m]},getDOMElement:function(l){return typeof(l)=="String"?document.getElementById(l):l},getElementObject:a,getOffset:function(l){var m=l.getPosition();return{left:m.x,top:m.y}},getOriginalEvent:function(l){return l.event},getPageXY:function(l){return[l.event.pageX,l.event.pageY]},getParent:function(l){return jsPlumb.CurrentLibrary.getElementObject(l).getParent()},getScrollLeft:function(l){return null},getScrollTop:function(l){return null},getSelector:function(l){return $$(l)},getSize:function(m){var l=m.getSize();return[l.x,l.y]},getTagName:function(l){var m=jsPlumb.CurrentLibrary.getElementObject(l);return m!=null?m.tagName:null},getUIPosition:function(l){var m=l[0],n=jsPlumb.CurrentLibrary.getElementObject(m).getPosition();return{left:n.x,top:n.y}},hasClass:function(m,l){return m.hasClass(l)},initDraggable:function(m,v,o){var l=jsPlumb.getId(m);var q=k[l];if(!q){var n=0,p=null,s=jsPlumb.Defaults.DragOptions.zIndex||2000;v.onStart=jsPlumb.wrap(v.onStart,function(){n=this.element.getStyle("z-index");this.element.setStyle("z-index",s);q.originalZIndex=n;if(jsPlumb.Defaults.DragOptions.cursor){p=this.element.getStyle("cursor");this.element.setStyle("cursor",jsPlumb.Defaults.DragOptions.cursor)}});v.onComplete=jsPlumb.wrap(v.onComplete,function(){this.element.setStyle("z-index",n);if(p){this.element.setStyle("cursor",p)}});var u=""+(v.scope||jsPlumb.Defaults.Scope),r=function(w){return w.get("id")!=m.get("id")},t=b[u]?b[u].filter(r):[];if(o){v.droppables=t;v.onLeave=jsPlumb.wrap(v.onLeave,function(w,x){if(x){g(x,false);e(w,x,"onLeave")}});v.onEnter=jsPlumb.wrap(v.onEnter,function(w,x){if(x){g(x,true);e(w,x,"onEnter")}});v.onDrop=function(w,y,x){if(y){g(y,false);e(w,y,"onDrop",x)}}}else{v.droppables=[]}q=new Drag.Move(m,v);q.scope=u;q.originalZIndex=n;c(k,m.get("id"),q);if(o){c(h,u,q)}if(v.disabled){q.detach()}}return q},initDroppable:function(m,t,n,r){var s=t.scope;c(b,s,m);var l=jsPlumb.getId(m);m.setAttribute("_isPermanentDroppable",r);i[l]=t;f[l]=s;var p=function(u){return u.element!=m},q=h[s]?h[s].filter(p):[];for(var o=0;o<q.length;o++){q[o].droppables.push(m)}},isAlreadyDraggable:function(l){return k[jsPlumb.getId(l)]!=null},isDragSupported:function(m,l){return typeof Drag!="undefined"},isDropSupported:function(m,l){return(typeof Drag!=undefined&&typeof Drag.Move!=undefined)},removeClass:function(m,l){m=jsPlumb.CurrentLibrary.getElementObject(m);try{if(m.className.constructor==SVGAnimatedString){jsPlumbUtil.svg.removeClass(m,l)}else{m.removeClass(l)}}catch(n){m.removeClass(l)}},removeElement:function(l,n){var m=a(l);if(m){m.dispose()}},setAttribute:function(m,n,l){m.set(n,l)},setDraggable:function(n,m){var l=k[n.get("id")];if(l){l.each(function(o){if(m){o.attach()}else{o.detach()}})}},setDragScope:function(o,n){var m=k[o.get("id")];var p=function(q){return q.get("id")!=o.get("id")};var l=b[n]?b[n].filter(p):[];m[0].droppables=l},setOffset:function(l,m){a(l).setPosition({x:m.left,y:m.top})},stopDrag:function(){for(var m in k){for(var l=0;l<k[m].length;l++){var n=k[m][l];n.stop();if(n.originalZIndex!=0){n.element.setStyle("z-index",n.originalZIndex)}}}},trigger:function(m,n,l){l.stopPropagation();a(m).fireEvent(n,l)},unbind:function(l,m,n){l=a(l);l.removeEvent(m,n)}};window.addEvent("domready",jsPlumb.init)})();(function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(l){return 0==l?0:0<l?1:-1});var d={subtract:function(m,l){return{x:m.x-l.x,y:m.y-l.y}},dotProduct:function(m,l){return m.x*l.x+m.y*l.y},square:function(l){return Math.sqrt(l.x*l.x+l.y*l.y)},scale:function(m,l){return{x:m.x*l,y:m.y*l}}},f=Math.pow(2,-65),h=function(y,x){for(var t=[],v=x.length-1,r=2*v-1,s=[],w=[],p=[],q=[],o=[[1,0.6,0.3,0.1],[0.4,0.6,0.6,0.4],[0.1,0.3,0.6,1]],u=0;u<=v;u++){s[u]=d.subtract(x[u],y)}for(u=0;u<=v-1;u++){w[u]=d.subtract(x[u+1],x[u]);w[u]=d.scale(w[u],3)}for(u=0;u<=v-1;u++){for(var m=0;m<=v;m++){p[u]||(p[u]=[]);p[u][m]=d.dotProduct(w[u],s[m])}}for(u=0;u<=r;u++){q[u]||(q[u]=[]);q[u].y=0;q[u].x=parseFloat(u)/r}r=v-1;for(s=0;s<=v+r;s++){u=Math.max(0,s-r);for(w=Math.min(s,v);u<=w;u++){j=s-u;q[u+j].y=q[u+j].y+p[j][u]*o[j][u]}}v=x.length-1;q=a(q,2*v-1,t,0);r=d.subtract(y,x[0]);p=d.square(r);for(u=o=0;u<q;u++){r=d.subtract(y,k(x,v,t[u],null,null));r=d.square(r);if(r<p){p=r;o=t[u]}}r=d.subtract(y,x[v]);r=d.square(r);if(r<p){p=r;o=1}return{location:o,distance:p}},a=function(C,B,x,z){var v=[],w=[],A=[],t=[],u=0,s,y;y=Math.sgn(C[0].y);for(var q=1;q<=B;q++){s=Math.sgn(C[q].y);s!=y&&u++;y=s}switch(u){case 0:return 0;case 1:if(z>=64){x[0]=(C[0].x+C[B].x)/2;return 1}var p,u=C[0].y-C[B].y;y=C[B].x-C[0].x;q=C[0].x*C[B].y-C[B].x*C[0].y;s=max_distance_below=0;for(p=1;p<B;p++){var r=u*C[p].x+y*C[p].y+q;r>s?s=r:r<max_distance_below&&(max_distance_below=r)}p=y;s=(1*(q-s)-p*0)*(1/(0*p-u*1));p=y;y=q-max_distance_below;u=(1*y-p*0)*(1/(0*p-u*1));y=Math.min(s,u);if(Math.max(s,u)-y<f){A=C[B].x-C[0].x;t=C[B].y-C[0].y;x[0]=0+1*(A*(C[0].y-0)-t*(C[0].x-0))*(1/(A*0-t*1));return 1}}k(C,B,0.5,v,w);C=a(v,B,A,z+1);B=a(w,B,t,z+1);for(z=0;z<C;z++){x[z]=A[z]}for(z=0;z<B;z++){x[z+C]=t[z]}return C+B},k=function(m,l,p,q,n){for(var o=[[]],r=0;r<=l;r++){o[0][r]=m[r]}for(m=1;m<=l;m++){for(r=0;r<=l-m;r++){o[m]||(o[m]=[]);o[m][r]||(o[m][r]={});o[m][r].x=(1-p)*o[m-1][r].x+p*o[m-1][r+1].x;o[m][r].y=(1-p)*o[m-1][r].y+p*o[m-1][r+1].y}}if(q!=null){for(r=0;r<=l;r++){q[r]=o[r][0]}}if(n!=null){for(r=0;r<=l;r++){n[r]=o[l-r][r]}}return o[l][0]},g={},e=function(t){var s=g[t];if(!s){var s=[],p=function(u){return function(){return u}},q=function(){return function(u){return u}},n=function(){return function(u){return 1-u}},o=function(u){return function(v){for(var x=1,w=0;w<u.length;w++){x=x*u[w](v)}return x}};s.push(new function(){return function(u){return Math.pow(u,t)}});for(var r=1;r<t;r++){for(var l=[new p(t)],m=0;m<t-r;m++){l.push(new q)}for(m=0;m<r;m++){l.push(new n)}s.push(new o(l))}s.push(new function(){return function(u){return Math.pow(1-u,t)}});g[t]=s}return s},c=function(m,l){for(var p=e(m.length-1),q=0,n=0,o=0;o<m.length;o++){q=q+m[o].x*p[o](l);n=n+m[o].y*p[o](l)}return{x:q,y:n}},b=function(m,l,p){for(var q=c(m,l),n=0,o=p>0?1:-1,r=null;n<Math.abs(p);){l=l+0.005*o;r=c(m,l);n=n+Math.sqrt(Math.pow(r.x-q.x,2)+Math.pow(r.y-q.y,2));q=r}return{point:r,location:l}},i=function(m,l){var o=c(m,l),p=c(m.slice(0,m.length-1),l),n=p.y-o.y,o=p.x-o.x;return n==0?Infinity:Math.atan(n/o)};window.jsBezier={distanceFromCurve:h,gradientAtPoint:i,gradientAtPointAlongCurveFrom:function(m,l,n){l=b(m,l,n);if(l.location>1){l.location=1}if(l.location<0){l.location=0}return i(m,l.location)},nearestPointOnCurve:function(m,l){var n=h(m,l);return{point:k(l,l.length-1,n.location,null,null),location:n.location}},pointOnCurve:c,pointAlongCurveFrom:function(m,l,n){return b(m,l,n).point},perpendicularToCurveAt:function(m,l,n,o){l=b(m,l,o==null?0:o);m=i(m,l.location);o=Math.atan(-1/m);m=n/2*Math.sin(o);n=n/2*Math.cos(o);return[{x:l.point.x+n,y:l.point.y+m},{x:l.point.x-n,y:l.point.y-m}]},locationAlongCurveFrom:function(m,l,n){return b(m,l,n).location}}})();